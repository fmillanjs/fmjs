@import "tailwindcss";
@import "tw-animate-css";

/* Radix Colors — light scales (scope to :root and .light) */
@import "@radix-ui/colors/slate.css";
@import "@radix-ui/colors/blue.css";
@import "@radix-ui/colors/red.css";
@import "@radix-ui/colors/green.css";
@import "@radix-ui/colors/amber.css";
@import "@radix-ui/colors/slate-alpha.css";
@import "@radix-ui/colors/blue-alpha.css";

/* Radix Colors — dark scales (scope to .dark and .dark-theme) */
@import "@radix-ui/colors/slate-dark.css";
@import "@radix-ui/colors/blue-dark.css";
@import "@radix-ui/colors/red-dark.css";
@import "@radix-ui/colors/green-dark.css";
@import "@radix-ui/colors/amber-dark.css";
@import "@radix-ui/colors/slate-dark-alpha.css";
@import "@radix-ui/colors/blue-dark-alpha.css";

/* Enable class-based dark mode — next-themes writes class="dark" to <html> */
/* Without this, Tailwind v4 dark: utilities only respond to prefers-color-scheme */
@custom-variant dark (&:where(.dark, .dark *));

/* ============================================================
   Semantic token layer — map Radix scale steps to Shadcn names
   Light values are active by default (:root)
   Dark values activate automatically when .dark is on <html>
   via the Radix dark CSS files imported above
   ============================================================ */
:root {
  --radius: 0.5rem;

  /* Backgrounds */
  --background: var(--slate-1);
  --foreground: var(--slate-12);

  --card: var(--slate-2);
  --card-foreground: var(--slate-12);

  --popover: var(--slate-1);
  --popover-foreground: var(--slate-12);

  /* Primary — Blue scale, step 11 = darkest accessible blue for WCAG 2 AA compliance */
  /* blue-11 light (#0d74ce) has 4.93:1 contrast with white — passes 4.5:1 requirement */
  /* blue-9 (#0090ff) only achieves 2.99:1 with white — does NOT meet WCAG 2 AA */
  --primary: var(--blue-11);
  --primary-foreground: #ffffff;

  /* Secondary — slate-3 background with slate-11 text */
  /* Fixes Phase 8: muted-foreground 4.35:1 → slate-11 guarantees Lc 60+ APCA */
  --secondary: var(--slate-3);
  --secondary-foreground: var(--slate-11);

  /* Muted */
  --muted: var(--slate-3);
  --muted-foreground: var(--slate-11);

  /* Accent — blue-3 background with blue-12 text */
  /* Fixes Phase 8 CRITICAL: accent text must be 4.5:1+. blue-12 (#113264) on blue-3 (#e6f4fe) = 10.9:1 */
  /* blue-11 (#0d74ce) on blue-3 only achieves ~4.25:1 in P3 display gamut — does not reliably pass */
  --accent: var(--blue-3);
  --accent-foreground: var(--blue-12);

  /* Destructive */
  --destructive: var(--red-9);
  --destructive-foreground: #ffffff;

  /* Success */
  --success: var(--green-9);
  --success-foreground: #ffffff;

  /* Warning — amber-9 bg with amber-12 text */
  /* Fixes Phase 8 CRITICAL: warning was 1.01:1, amber-12 on amber-9 satisfies 4.5:1 */
  --warning: var(--amber-9);
  --warning-foreground: var(--amber-12);

  /* UI elements */
  /* Fixes Phase 8 HIGH: all borders were 1.18-1.58:1, slate-6 guarantees 3:1 for non-interactive borders */
  --border: var(--slate-6);
  --input: var(--slate-6);
  --ring: var(--blue-8);

  /* Matrix green token system — Phase 22 */
  --matrix-green: #00FF41;
  --matrix-green-dim: #00CC33;
  --matrix-green-ghost: #00FF4120;
}

/* Dark mode semantic token overrides */
/* Radix dark CSS auto-updates --blue-11 to #70b8ff (light blue, readable on dark backgrounds) */
/* Override primary-foreground for dark mode: white on #70b8ff is only 2.1:1 — fails WCAG AA */
/* Use very dark slate (#111113 = --slate-1 dark) on #70b8ff for 9.04:1 contrast — passes AA */
.dark {
  --primary-foreground: var(--slate-1);
}

/* THEME-01: Dark-first theming for portfolio routes */
/* .matrix-theme is on the wrapper div in apps/web/app/(portfolio)/layout.tsx */
/* Scoped to portfolio routes only — dashboard routes (TeamFlow/DevCollab) are unaffected */
/* Does not touch <html>, .dark, or the Radix Colors cascade */
.matrix-theme {
  background-color: #0a0a0a;
  color: #e8e8e8;
}

html:not(.dark) .matrix-theme {
  background-color: var(--background);
  color: var(--foreground);
}

/* Expose semantic tokens as Tailwind CSS utilities via @theme inline */
/* The 'inline' keyword is REQUIRED for Tailwind v4 — do not use @theme without inline */
/* CSS variables here define bg-background, text-foreground, border-border, etc. */
@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-success: var(--success);
  --color-success-foreground: var(--success-foreground);
  --color-warning: var(--warning);
  --color-warning-foreground: var(--warning-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --radius: var(--radius);
}

/* Custom animation (carried forward from previous globals.css) */
@keyframes slide-in-up {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.animate-slide-in-up {
  animation: slide-in-up 0.3s ease-out;
}

/* FX-02: Blinking terminal cursor after hero tagline */
@keyframes cursor-blink {
  0%, 100% { opacity: 1; }
  50%       { opacity: 0; }
}

.cursor-blink::after {
  content: "_";
  display: inline-block;
  margin-left: 1px;
  animation: cursor-blink 1s steps(2, start) infinite;
  color: var(--matrix-green);
}

/* UX-01: Matrix green border glow on project card hover */
.card-glow-hover {
  transition: box-shadow 0.2s ease;
}

.card-glow-hover:hover {
  box-shadow:
    0 0 0 1px var(--matrix-green),
    0 0 20px 0 var(--matrix-green-ghost),
    0 4px 24px 0 rgba(0, 255, 65, 0.15);
}

/* FX-04: Dot grid background + green spotlight cursor */
/* Hidden entirely on touch / coarse-pointer / no-hover devices via @media guard */
/* On hover-capable devices: dot grid is always visible; spotlight follows mouse */
@media (any-hover: hover) {
  .dot-grid-spotlight {
    position: fixed;
    inset: 0;
    z-index: 0;           /* behind content layers (content uses z-10+) */
    pointer-events: none; /* NEVER block clicks — mandatory */
    /* Three-layer background:
       1. Green radial spotlight at cursor position
       2+3. Offset dot grid (two patterns create a denser grid by offset) */
    background-image:
      radial-gradient(
        circle 250px at var(--cursor-x, -9999px) var(--cursor-y, -9999px),
        var(--matrix-green-ghost),
        transparent 80%
      ),
      radial-gradient(circle, var(--matrix-green-dim) 1px, transparent 1px),
      radial-gradient(circle, var(--matrix-green-dim) 1px, transparent 1px);
    background-size:
      100% 100%,
      28px 28px,
      28px 28px;
    background-position:
      0 0,
      0 0,
      14px 14px;   /* offset second pattern by half-step for denser grid */
    opacity: 0.08; /* subtle — visible but not distracting; content remains primary focus */
  }
}

/* THEME-04: Stop all animations when OS Reduce Motion is active */
/* Phase 22 portion — covers CSS animations/transitions globally */
/* Canvas RAF check (Phase 23) and MotionConfig (Phase 24) handle JS animation layers */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
