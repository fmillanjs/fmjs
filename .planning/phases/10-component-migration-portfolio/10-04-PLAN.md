---
phase: 10-component-migration-portfolio
plan: "04"
type: execute
wave: 3
depends_on:
  - "10-02"
  - "10-03"
files_modified: []
autonomous: false
requirements:
  - MIG-01

must_haves:
  truths:
    - "Portfolio homepage renders using Shadcn Card, Badge, Button components (visible in browser)"
    - "Portfolio projects page renders project cards using Shadcn Card + Badge with consistent styling"
    - "Light mode and dark mode screenshots are captured as baseline snapshots for all 6 portfolio pages"
    - "All 6 portfolio pages pass automated WCAG AA accessibility audit with zero violations"
    - "Human has visually verified that portfolio pages look correct in both light and dark modes"
  artifacts:
    - path: "apps/web/e2e/portfolio/visual-regression.spec.ts-snapshots/"
      provides: "12 baseline screenshots (6 pages x 2 modes)"
      contains: "homepage-light.png"
    - path: "apps/web/e2e/portfolio/accessibility.spec.ts"
      provides: "WCAG AA test suite that passes with 0 violations"
  key_links:
    - from: "apps/web/e2e/portfolio/accessibility.spec.ts"
      to: "portfolio pages"
      via: "Playwright page.goto + AxeBuilder.analyze()"
      pattern: "violations.*toEqual\\(\\[\\]\\)"
    - from: "apps/web/e2e/portfolio/visual-regression.spec.ts"
      to: "visual-regression.spec.ts-snapshots/"
      via: "toHaveScreenshot() first run creates baselines"
      pattern: "toHaveScreenshot"
---

<objective>
Run the visual regression tests (creating baseline screenshots) and accessibility tests, then checkpoint for human visual verification of all portfolio pages in both light and dark modes.

Purpose: Verifies the full MIG-01 requirement is met: pages render correctly, WCAG AA compliance is proven programmatically, and baselines are captured for future regression detection.
Output: 12 screenshot baselines committed, 0 axe violations confirmed, human-approved visual quality.
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-component-migration-portfolio/10-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run tests — generate screenshot baselines and verify WCAG AA</name>
  <files></files>
  <action>
**Step 1: Verify the dev server is running.**
Check if a Docker container or local dev server is already running before starting one:
```bash
# Check for running dev server
curl -s -o /dev/null -w "%{http_code}" http://localhost:3000/ 2>/dev/null || echo "not running"
```

If not running, start the web app dev server:
```bash
cd /home/doctor/fernandomillan && npm run dev --workspace=apps/web &
# Wait for server to be ready
sleep 8
```

**Step 2: Run visual regression tests to generate baseline screenshots.**
First run of `toHaveScreenshot()` creates the baselines automatically — no `--update-snapshots` flag needed on first run.

```bash
cd /home/doctor/fernandomillan && npx playwright test e2e/portfolio/visual-regression.spec.ts \
  --project=chromium \
  --reporter=list \
  2>&1
```

Expected: All 12 tests pass (6 pages x 2 modes). On first run, missing snapshots are created and tests pass. If any test fails, check the error — likely a page load issue (increase `waitForLoadState` timeout) or a snapshot mismatch (use `--update-snapshots`).

**Step 3: Run accessibility tests.**
```bash
cd /home/doctor/fernandomillan && npx playwright test e2e/portfolio/accessibility.spec.ts \
  --project=chromium \
  --reporter=list \
  2>&1
```

Expected: All 12 tests pass with 0 violations (6 pages x 2 modes).

If violations are found: The test output will list specific axe violation rules and affected elements. Fix the reported violations in the relevant page/component files, then re-run. Common fixes:
- Missing alt text on images → add `alt` attribute
- Insufficient color contrast → verify semantic tokens are applied correctly
- Missing form labels → ensure `Label htmlFor` matches input `id`

**Step 4: Commit the baseline screenshots.**
After both test suites pass:
```bash
cd /home/doctor/fernandomillan && git add apps/web/e2e/portfolio/ && \
  git commit -m "test(10-04): add visual regression baselines and accessibility tests for portfolio"
```
  </action>
  <verify>
```bash
# Screenshot baselines created
ls /home/doctor/fernandomillan/apps/web/e2e/portfolio/visual-regression.spec.ts-snapshots/ 2>/dev/null | head -15

# Both test suites passed (check last test run output or run again)
cd /home/doctor/fernandomillan && npx playwright test e2e/portfolio/ \
  --project=chromium \
  --reporter=list \
  2>&1 | tail -20
```
  </verify>
  <done>
Screenshot snapshots directory exists with 12 `.png` baseline files (homepage-light.png, homepage-dark.png, etc.). Both visual regression and accessibility test suites pass with 0 failures. Baselines committed to git.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Human visual verification of migrated portfolio</name>
  <action>Pause for human visual verification of all portfolio pages in both light and dark modes.</action>
  <verify>Human approves the visual appearance and confirms no purple colors, correct dark mode, and consistent Shadcn component styling.</verify>
  <done>Human types "approved" confirming pages look correct in both modes.</done>
  <what-built>
    Full portfolio migration to Shadcn UI components. All 6 portfolio pages use Card, Badge, Button, Input, Label, Textarea primitives with semantic design tokens. Visual regression baselines captured. Automated WCAG AA accessibility tests pass with 0 violations.
  </what-built>
  <how-to-verify>
    1. Open http://localhost:3000/ — verify homepage looks correct: project cards have consistent styling with Card borders, Badge chips for tech tags, Button for CTAs

    2. Click through all portfolio pages and verify visual consistency:
       - /about — value-proposition boxes should use Card with consistent borders
       - /projects — project grid using Shadcn Card (not raw bordered divs), tech tags as Badge
       - /projects/teamflow — case study with Button CTAs for GitHub/live demo links
       - /resume — download button uses primary Button styling
       - /contact — contact form with consistent Input, Label, Textarea, Button styling

    3. Toggle dark mode (using the ThemeToggle in nav) — verify all pages look correct in dark mode:
       - Cards should show the dark card background (not bg-white)
       - Muted text should be readable (not hard-coded gray)
       - Badges and buttons should use correct dark mode colors

    4. Check that NO purple appears anywhere in the portfolio (user requirement: never use purple)

    5. Run a quick manual accessibility check: Tab through the homepage — all interactive elements should be reachable with visible focus rings
  </how-to-verify>
  <resume-signal>Type "approved" if pages look correct in both modes, or describe any visual issues to fix</resume-signal>
</task>

</tasks>

<verification>
1. `npx playwright test e2e/portfolio/` exits with 0 failures
2. Screenshot baselines in `e2e/portfolio/visual-regression.spec.ts-snapshots/` contain 12 files
3. Human verified all pages visually in both light and dark modes
4. Zero purple color used anywhere in portfolio pages (global requirement)
5. Final grep confirms zero hardcoded color classes: `grep -rn "bg-white|bg-gray-|text-gray-|border-gray-|bg-blue-" apps/web/app/(portfolio) apps/web/components/portfolio`
</verification>

<success_criteria>
All Playwright tests pass. 12 screenshot baselines committed. Human has approved visual quality in both light and dark modes. Zero axe WCAG AA violations. Phase 10 MIG-01 requirement fully satisfied.
</success_criteria>

<output>
After completion, create `.planning/phases/10-component-migration-portfolio/10-04-SUMMARY.md`
</output>
