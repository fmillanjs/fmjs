---
phase: 28-devcollab-ui-debt-closure
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/devcollab-web/app/dashboard/page.tsx
  - apps/devcollab-web/components/CreateWorkspaceForm.tsx
  - apps/web/public/resume.pdf
  - apps/web/components/portfolio/footer.tsx
  - apps/web/components/portfolio/hero-section.tsx
  - apps/web/app/(portfolio)/about/page.tsx
  - apps/web/app/(portfolio)/resume/page.tsx
  - apps/web/app/(portfolio)/projects/devcollab/page.tsx
  - apps/web/app/(portfolio)/projects/teamflow/page.tsx
autonomous: true
requirements:
  - FIX-02
  - UI-01

must_haves:
  truths:
    - "Visiting /dashboard while logged out redirects to /login server-side with no content flash"
    - "Visiting /dashboard while logged in shows workspaces and create form as before"
    - "Downloading /resume.pdf on fernandomillan.dev delivers a real PDF file, not a 404"
    - "Footer GitHub link points to https://github.com/fmillanjs"
    - "Footer LinkedIn link is replaced with CodeSignal link (https://codesignal.com/learn/profile/cmiqnphkm008cjs0444t3ea1t)"
    - "Hero section GitHub button points to https://github.com/fmillanjs"
  artifacts:
    - path: "apps/devcollab-web/app/dashboard/page.tsx"
      provides: "Server component with auth guard + server-side workspace fetch"
      contains: "await cookies()"
    - path: "apps/devcollab-web/components/CreateWorkspaceForm.tsx"
      provides: "Client component for create workspace form"
      contains: "'use client'"
    - path: "apps/web/public/resume.pdf"
      provides: "Real PDF file served as static asset"
    - path: "apps/web/components/portfolio/footer.tsx"
      provides: "Footer with corrected social links"
      contains: "fmillanjs"
  key_links:
    - from: "apps/devcollab-web/app/dashboard/page.tsx"
      to: "apps/devcollab-web/components/CreateWorkspaceForm.tsx"
      via: "import and render as child"
      pattern: "CreateWorkspaceForm"
    - from: "apps/web/app/(portfolio)/resume/page.tsx"
      to: "apps/web/public/resume.pdf"
      via: "href=/resume.pdf"
      pattern: "href.*resume\\.pdf"
---

<objective>
Convert dashboard/page.tsx from a client component to a server component with server-side auth redirect, then fix all portfolio social links and serve the real resume PDF.

Purpose: Eliminate the auth flash on /dashboard (unauthenticated users currently see a blank page before client-side code redirects) and make the portfolio accurate with correct social links and a downloadable PDF resume.
Output: New server-component dashboard, CreateWorkspaceForm client component, resume.pdf in public/, corrected footer/hero/about/resume page copy.
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@apps/devcollab-web/app/w/[slug]/layout.tsx
@apps/devcollab-web/app/dashboard/page.tsx
@apps/web/components/portfolio/footer.tsx
@apps/web/components/portfolio/hero-section.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Convert dashboard to server component with auth guard</name>
  <files>apps/devcollab-web/app/dashboard/page.tsx
apps/devcollab-web/components/CreateWorkspaceForm.tsx</files>
  <action>
The current `apps/devcollab-web/app/dashboard/page.tsx` is a `'use client'` component with NO auth guard — unauthenticated visitors see a blank flash before any client redirect runs.

**Step 1 — Create `apps/devcollab-web/components/CreateWorkspaceForm.tsx`:**
Extract the create-workspace form from the current dashboard page into a standalone `'use client'` component. It receives an `onCreated: (workspace: Workspace) => void` prop (or handles its own list refresh via router.refresh()). Actually since the parent will be a server component that cannot hold mutable state, the form should NOT use a callback prop. Instead, after a successful POST, call `window.location.reload()` or use Next.js router.refresh(). Use `router.refresh()` from `useRouter` (next/navigation) — this re-runs the server component and re-fetches workspaces without a full page reload.

The form component signature:
```typescript
'use client';
import { useState } from 'react';
import { useRouter } from 'next/navigation';

const API_URL = process.env.NEXT_PUBLIC_API_URL ?? 'http://localhost:3003';

export default function CreateWorkspaceForm() {
  const router = useRouter();
  const [name, setName] = useState('');
  const [slug, setSlug] = useState('');
  const [creating, setCreating] = useState(false);
  const [error, setError] = useState('');

  async function handleCreate(e: React.FormEvent) {
    e.preventDefault();
    setCreating(true);
    setError('');
    try {
      const res = await fetch(`${API_URL}/workspaces`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        credentials: 'include',
        body: JSON.stringify({ name, slug: slug || undefined }),
      });
      if (res.ok) {
        setName('');
        setSlug('');
        router.refresh(); // re-runs server component, re-fetches workspace list
      } else {
        const data = await res.json();
        setError(data.message ?? 'Failed to create workspace');
      }
    } catch {
      setError('Network error. Please try again.');
    } finally {
      setCreating(false);
    }
  }

  return (
    <form onSubmit={handleCreate} style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem', maxWidth: '320px' }}>
      <input
        type="text"
        placeholder="Workspace name"
        value={name}
        onChange={(e) => setName(e.target.value)}
        required
        style={{ padding: '0.5rem', border: '1px solid #d1d5db', borderRadius: '6px' }}
      />
      <input
        type="text"
        placeholder="Slug (optional, auto-generated)"
        value={slug}
        onChange={(e) => setSlug(e.target.value)}
        style={{ padding: '0.5rem', border: '1px solid #d1d5db', borderRadius: '6px' }}
      />
      {error && <p style={{ color: '#dc2626', fontSize: '0.875rem' }}>{error}</p>}
      <button
        type="submit"
        disabled={creating}
        style={{
          padding: '0.5rem 1rem',
          background: '#3b82f6',
          color: '#fff',
          border: 'none',
          borderRadius: '6px',
          cursor: creating ? 'not-allowed' : 'pointer',
        }}
      >
        {creating ? 'Creating...' : 'Create'}
      </button>
    </form>
  );
}
```

**Step 2 — Rewrite `apps/devcollab-web/app/dashboard/page.tsx` as a server component:**

REMOVE the `'use client'` directive entirely. The new file must:
1. Import `cookies` from `next/headers` and `redirect` from `next/navigation`
2. Check for `devcollab_token` cookie — redirect to `/login` if absent (exact pattern from `app/w/[slug]/layout.tsx`)
3. Fetch `/workspaces` server-side using the cookie as the auth header (pattern from `app/w/[slug]/activity/page.tsx`)
4. Render the workspaces list + `<CreateWorkspaceForm />` child component

```typescript
import { cookies } from 'next/headers';
import { redirect } from 'next/navigation';
import CreateWorkspaceForm from '../../components/CreateWorkspaceForm';

const API_URL = process.env.NEXT_PUBLIC_API_URL ?? 'http://localhost:3003';

interface Workspace {
  id: string;
  name: string;
  slug: string;
  members: Array<{ role: string; userId: string }>;
}

async function getWorkspaces(token: string): Promise<Workspace[]> {
  try {
    const res = await fetch(`${API_URL}/workspaces`, {
      headers: { Cookie: `devcollab_token=${token}` },
      cache: 'no-store',
    });
    if (!res.ok) return [];
    return res.json();
  } catch {
    return [];
  }
}

export default async function DashboardPage() {
  const cookieStore = await cookies();
  const token = cookieStore.get('devcollab_token')?.value;
  if (!token) {
    redirect('/login');
  }

  const workspaces = await getWorkspaces(token);

  return (
    <main style={{ padding: '2rem', fontFamily: 'system-ui, sans-serif', maxWidth: '700px' }}>
      <h1 style={{ marginBottom: '1.5rem' }}>Dashboard</h1>

      <section style={{ marginBottom: '2rem' }}>
        <h2 style={{ fontSize: '1.1rem', fontWeight: 600, marginBottom: '0.75rem' }}>
          Your Workspaces
        </h2>
        {workspaces.length === 0 ? (
          <p style={{ color: '#6b7280' }}>No workspaces yet. Create one below.</p>
        ) : (
          <ul style={{ listStyle: 'none', padding: 0, margin: 0 }}>
            {workspaces.map((ws) => (
              <li key={ws.id} style={{ marginBottom: '0.5rem' }}>
                <a
                  href={`/w/${ws.slug}`}
                  style={{ color: '#3b82f6', textDecoration: 'none', fontWeight: 500 }}
                >
                  {ws.name}
                </a>
                <span style={{ color: '#9ca3af', marginLeft: '0.5rem', fontSize: '0.875rem' }}>
                  /{ws.slug} · {ws.members?.length ?? 0} member
                  {(ws.members?.length ?? 0) !== 1 ? 's' : ''}
                </span>
              </li>
            ))}
          </ul>
        )}
      </section>

      <section>
        <h2 style={{ fontSize: '1.1rem', fontWeight: 600, marginBottom: '0.75rem' }}>
          Create Workspace
        </h2>
        <CreateWorkspaceForm />
      </section>

      <div style={{ marginTop: '2rem', borderTop: '1px solid #e5e7eb', paddingTop: '1rem' }}>
        <a href="/api/logout" style={{ color: '#6b7280', fontSize: '0.875rem' }}>
          Log out
        </a>
      </div>
    </main>
  );
}
```

**CRITICAL anti-pattern check:** Verify the final `dashboard/page.tsx` does NOT contain `'use client'` at the top. If it does, the auth guard will not work server-side.
  </action>
  <verify>Run `grep -n "'use client'" apps/devcollab-web/app/dashboard/page.tsx` — must return nothing (no 'use client' directive). Run `grep -n "await cookies\|redirect\|devcollab_token" apps/devcollab-web/app/dashboard/page.tsx` — must show all three patterns. Run `grep -n "'use client'\|useRouter\|CreateWorkspaceForm" apps/devcollab-web/components/CreateWorkspaceForm.tsx` — must show all three. Run `cd /home/doctor/fernandomillan && docker ps` to check if devcollab-web container is running; if so test with `curl -s -o /dev/null -w "%{http_code}" http://localhost:3001/dashboard` — should return 307 (redirect to login) without a session cookie.</verify>
  <done>dashboard/page.tsx has no 'use client', contains `await cookies()` and `redirect('/login')`. CreateWorkspaceForm.tsx is a separate client component with 'use client' and useRouter. An unauthenticated request to /dashboard returns a redirect (307/302) before rendering any HTML content.</done>
</task>

<task type="auto">
  <name>Task 2: Resume PDF + portfolio social link fixes</name>
  <files>apps/web/public/resume.pdf
apps/web/components/portfolio/footer.tsx
apps/web/components/portfolio/hero-section.tsx
apps/web/app/(portfolio)/about/page.tsx
apps/web/app/(portfolio)/resume/page.tsx
apps/web/app/(portfolio)/projects/devcollab/page.tsx
apps/web/app/(portfolio)/projects/teamflow/page.tsx</files>
  <action>
**Step 1 — Copy resume PDF to public directory:**

The file `resume.pdf` exists at the project root (`/home/doctor/fernandomillan/resume.pdf`). Copy it to `apps/web/public/resume.pdf`:
```bash
cp resume.pdf apps/web/public/resume.pdf
```
This makes it available at `https://fernandomillan.dev/resume.pdf`. The Dockerfile already copies `apps/web/public/` to the runner stage — no Dockerfile changes needed. The file MUST be committed to git or the Docker build will not include it.

**Step 2 — Fix `apps/web/components/portfolio/footer.tsx`:**

Two changes:
1. Change GitHub href from `https://github.com/fernandomillan` to `https://github.com/fmillanjs`
2. Replace the LinkedIn link with a CodeSignal link. Replace the entire LinkedIn `<a>` block:
   - Old: `<a href="https://www.linkedin.com/in/fernandomillan" ... aria-label="LinkedIn"><Linkedin className="w-5 h-5" /></a>`
   - New: `<a href="https://codesignal.com/learn/profile/cmiqnphkm008cjs0444t3ea1t" target="_blank" rel="noopener noreferrer" className="text-muted-foreground hover:text-primary transition-colors" aria-label="CodeSignal">CS</a>`
   - Use the text "CS" as the link content (no icon needed — CodeSignal has no lucide icon). Style it to match the icon size: `style={{ fontSize: '14px', fontWeight: 700 }}` or use the `ExternalLink` icon from lucide-react.
   - Remove the `Linkedin` import from lucide-react. Add `ExternalLink` import if using that icon, OR keep it as text "CS" which is simpler and matches the portfolio minimal aesthetic.
   - Recommended: Use `<ExternalLink className="w-5 h-5" />` with `aria-label="CodeSignal"` for visual consistency with the GitHub icon.

**Step 3 — Fix `apps/web/components/portfolio/hero-section.tsx`:**

Change GitHub href from `https://github.com/fernandomillan` to `https://github.com/fmillanjs`.

**Step 4 — Update `apps/web/app/(portfolio)/about/page.tsx`:**

The about page bio text is generic. Replace the Professional Summary paragraphs with recruiter-optimized content:

Replace the three `<p>` paragraphs in the "Professional Summary" section with:
```
Paragraph 1: "I'm a senior full-stack engineer who shipped two production SaaS applications — TeamFlow (work management with real-time collaboration) and DevCollab (developer workspace platform) — from zero to deployed on a self-hosted VPS with Traefik, Docker, GHCR CI/CD, and PostgreSQL in under a week."
Paragraph 2: "My stack is Next.js 15, NestJS, TypeScript, PostgreSQL, and Redis. I use CASL for fine-grained RBAC, Prisma for type-safe database access, and Turborepo for monorepo orchestration. Both applications are live with HTTPS at custom domains — you can register, create workspaces, and explore the features right now."
Paragraph 3: "I'm actively seeking a senior full-stack engineering role where I can apply these skills to production systems with real users. I value clean architecture, type safety, and shipping working software over perfect plans."
```

**Step 5 — Update `apps/web/app/(portfolio)/resume/page.tsx`:**

1. Remove the "Note about PDF" placeholder box at the bottom (lines 226-240, the `<div className="mt-12 p-4 bg-muted...">` block with the "This is a customizable placeholder resume" text). The real PDF is now in place.
2. Update the Summary section text to match the about page — recruiter-optimized:
   Replace: "Full-stack engineer with expertise in building production-ready SaaS applications. Specializing in modern web technologies..."
   With: "Senior full-stack engineer who shipped two production SaaS applications (TeamFlow and DevCollab) from architecture to live deployment. Expert in Next.js 15, NestJS, TypeScript, PostgreSQL, Redis, and Docker. Proven track record of implementing real-time WebSocket systems, RBAC with CASL, CI/CD pipelines with GitHub Actions and GHCR, and self-hosted deployment on VPS with Traefik."
3. Update the Experience section "Personal Projects & Portfolio" bullet points to add DevCollab and remove the generic/vague entries:
   - "Architected and deployed TeamFlow (work management SaaS) and DevCollab (developer collaboration platform) — both live at HTTPS custom domains with full CI/CD"
   - "Implemented real-time collaboration with WebSocket + Redis pub/sub for horizontal scaling across both applications"
   - "Designed CASL RBAC with Admin/Contributor/Viewer roles, PATCH/DELETE protected by server-side authorization guards"
   - "Built Turborepo monorepo with shared TypeScript packages, Docker multi-stage builds, and GitHub Actions CI/CD deploying to self-hosted Coolify on a VPS"
   - "Shipped optimistic UI with automatic rollback, full-text search with pg_trgm, and invite link flows"

**Step 6 — Fix project pages GitHub links:**

In `apps/web/app/(portfolio)/projects/devcollab/page.tsx`: Change `https://github.com/fernandomillan/devcollab` to `https://github.com/fmillanjs/devcollab`.

In `apps/web/app/(portfolio)/projects/teamflow/page.tsx`: Change `https://github.com/fernandomillan/teamflow` to `https://github.com/fmillanjs/teamflow`.
  </action>
  <verify>Run `ls -la /home/doctor/fernandomillan/apps/web/public/resume.pdf` — must exist and have non-zero size. Run `grep -n "fmillanjs" apps/web/components/portfolio/footer.tsx apps/web/components/portfolio/hero-section.tsx apps/web/app/\(portfolio\)/projects/devcollab/page.tsx apps/web/app/\(portfolio\)/projects/teamflow/page.tsx` — all four files must show the corrected URL. Run `grep -n "codesignal\|CodeSignal" apps/web/components/portfolio/footer.tsx` — must show the CodeSignal link. Run `grep -n "fernandomillan/devcollab\|fernandomillan/teamflow\|linkedin.com/in/fernando" apps/web/components/portfolio/footer.tsx apps/web/components/portfolio/hero-section.tsx apps/web/app/\(portfolio\)/projects/devcollab/page.tsx` — must return nothing (old URLs removed). Run `grep -n "placeholder resume\|customizable" apps/web/app/\(portfolio\)/resume/page.tsx` — must return nothing.</verify>
  <done>resume.pdf exists in apps/web/public/. All GitHub links updated to fmillanjs. LinkedIn replaced with CodeSignal in footer. The placeholder "customizable resume" notice is removed from resume/page.tsx. About and resume pages have recruiter-optimized copy. Project page GitHub links corrected.</done>
</task>

</tasks>

<verification>
1. `grep -n "'use client'" apps/devcollab-web/app/dashboard/page.tsx` returns empty — confirms server component conversion
2. `grep -n "await cookies\|redirect('/login')" apps/devcollab-web/app/dashboard/page.tsx` shows both — confirms auth guard
3. `ls -la apps/web/public/resume.pdf` — file exists with size > 0
4. `git status apps/web/public/resume.pdf` shows the file is tracked (not just untracked) — must be committed
5. `grep "fmillanjs" apps/web/components/portfolio/footer.tsx apps/web/components/portfolio/hero-section.tsx` — correct GitHub URL in both
6. `grep "codesignal" apps/web/components/portfolio/footer.tsx` — CodeSignal link present
7. `grep "linkedin" apps/web/components/portfolio/footer.tsx` — must return nothing
</verification>

<success_criteria>
- dashboard/page.tsx is an async server component: no 'use client', has `await cookies()`, redirects to /login when no token
- CreateWorkspaceForm.tsx is a client component handling all interactive state
- resume.pdf committed to git at apps/web/public/resume.pdf
- Footer has correct GitHub (fmillanjs) + CodeSignal links, no LinkedIn
- Hero section GitHub button points to https://github.com/fmillanjs
- About and resume pages have recruiter-optimized copy without placeholder text
- Project pages GitHub links corrected to fmillanjs
</success_criteria>

<output>
After completion, create `.planning/phases/28-devcollab-ui-debt-closure/28-01-SUMMARY.md`
</output>
