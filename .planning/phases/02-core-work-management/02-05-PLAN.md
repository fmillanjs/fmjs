---
phase: 02-core-work-management
plan: 05
type: execute
wave: 5
depends_on: ["02-02"]
files_modified:
  - apps/web/app/(dashboard)/layout.tsx
  - apps/web/app/(dashboard)/page.tsx
  - apps/web/app/(dashboard)/teams/page.tsx
  - apps/web/app/(dashboard)/teams/new/page.tsx
  - apps/web/app/(dashboard)/teams/[teamId]/page.tsx
  - apps/web/app/(dashboard)/teams/[teamId]/settings/page.tsx
  - apps/web/components/teams/team-form.tsx
  - apps/web/components/teams/team-member-list.tsx
  - apps/web/components/teams/invite-member-form.tsx
  - apps/web/components/layout/sidebar.tsx
  - apps/web/components/layout/header.tsx
  - apps/web/lib/api.ts
autonomous: true

must_haves:
  truths:
    - "User sees dashboard with sidebar navigation to teams and projects"
    - "User can create a new team via form"
    - "User can view team overview with member list"
    - "User can invite members to team"
    - "Admin can remove members from team settings"
    - "Sidebar shows list of user's teams"
  artifacts:
    - path: "apps/web/components/layout/sidebar.tsx"
      provides: "Dashboard sidebar with team navigation"
    - path: "apps/web/components/teams/team-form.tsx"
      provides: "Team creation form"
    - path: "apps/web/components/teams/team-member-list.tsx"
      provides: "Team member list with role badges"
    - path: "apps/web/lib/api.ts"
      provides: "API client utility for backend calls"
  key_links:
    - from: "apps/web/lib/api.ts"
      to: "http://localhost:3001"
      via: "fetch calls to NestJS API"
      pattern: "fetch.*localhost:3001"
    - from: "apps/web/components/layout/sidebar.tsx"
      to: "/teams"
      via: "navigation links"
      pattern: "href.*teams"
---

<objective>
Build the dashboard layout (sidebar + header + content area) and Teams frontend pages: team list, team creation, team overview with member management. Create API client utility for frontend-to-backend communication.

Purpose: This is the first user-facing Phase 2 UI. The dashboard layout will be used by all subsequent frontend plans. Teams UI enables workspace management before projects and tasks can be created.
Output: Working dashboard with sidebar navigation and team management pages
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-core-work-management/02-RESEARCH.md
@.planning/phases/02-core-work-management/02-02-SUMMARY.md
@.planning/phases/01-foundation-authentication/01-04-SUMMARY.md
@apps/web/app/(dashboard)/layout.tsx
@apps/web/app/(dashboard)/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create dashboard layout with sidebar, header, and API client utility</name>
  <files>
    apps/web/components/layout/sidebar.tsx
    apps/web/components/layout/header.tsx
    apps/web/app/(dashboard)/layout.tsx
    apps/web/app/(dashboard)/page.tsx
    apps/web/lib/api.ts
  </files>
  <action>
    **Create lib/api.ts:**
    - API client helper that wraps fetch with:
      - Base URL from env: `process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001'`
      - Auto-attach JWT token from session (get from NextAuth session)
      - JSON content-type headers
      - Error handling (throw on non-2xx with parsed error body)
      - Methods: `api.get(path)`, `api.post(path, body)`, `api.patch(path, body)`, `api.delete(path)`
    - Also create server-side version using `auth()` from NextAuth to get session token for Server Components

    **Create components/layout/sidebar.tsx:**
    - Client component ('use client')
    - Fixed left sidebar (w-64, h-screen)
    - Logo/app name at top: "TeamFlow"
    - Navigation sections:
      - Dashboard (home icon, link to /)
      - Teams section header with list of user's teams (fetched via API or passed as prop)
      - Each team links to /teams/[teamId]
      - "Create Team" button/link at bottom of teams list
    - Active state styling on current route (use `usePathname()`)
    - Responsive: collapsible on mobile (hamburger menu in header)
    - Use shadcn/ui components (Button, ScrollArea) if available, otherwise plain Tailwind
    - Colors: Use blue/slate palette. NO purple anywhere.

    **Create components/layout/header.tsx:**
    - Top header bar (h-16, fixed or sticky)
    - Left: hamburger menu (mobile only), breadcrumb or page title
    - Right: user avatar dropdown (name, email, role badge, Profile link, Logout)
    - Use NextAuth session for user info

    **Update (dashboard)/layout.tsx:**
    - Wrap children with sidebar + header layout
    - Sidebar on left, content area on right with proper padding
    - Fetch user's teams for sidebar (Server Component can call API)
    - Pass session to header

    **Update (dashboard)/page.tsx:**
    - Dashboard home page
    - Show welcome message with user's name
    - Quick links: "Create a Team" if no teams, or list of recent teams/projects
    - Stats cards (placeholder for now): "X Teams", "X Projects", "X Tasks"
  </action>
  <verify>
    Start web app: `cd apps/web && npm run dev`. Navigate to http://localhost:3000:
    1. Dashboard shows sidebar with TeamFlow logo and navigation
    2. Header shows user name and avatar dropdown
    3. Sidebar shows teams list (empty if no teams)
    4. Dashboard page shows welcome message
    5. Responsive: sidebar collapses on mobile
  </verify>
  <done>Dashboard layout with sidebar, header, and content area. API client utility works for both client and server components. Navigation between pages works.</done>
</task>

<task type="auto">
  <name>Task 2: Create Teams frontend pages (list, create, overview, settings)</name>
  <files>
    apps/web/app/(dashboard)/teams/page.tsx
    apps/web/app/(dashboard)/teams/new/page.tsx
    apps/web/app/(dashboard)/teams/[teamId]/page.tsx
    apps/web/app/(dashboard)/teams/[teamId]/settings/page.tsx
    apps/web/components/teams/team-form.tsx
    apps/web/components/teams/team-member-list.tsx
    apps/web/components/teams/invite-member-form.tsx
  </files>
  <action>
    **Create components/teams/team-form.tsx:**
    - Client component with React Hook Form + Zod resolver
    - Fields: name (required, 2-50 chars)
    - Validates with createTeamSchema from @repo/shared
    - onSubmit calls API POST /teams
    - Shows loading state, success toast, redirects to team page
    - Use shadcn-style input and button components

    **Create components/teams/team-member-list.tsx:**
    - Displays list of team members
    - Each member shows: avatar (or initials), name, email, role badge (Admin/Manager/Member with colors)
    - Admin users see "Remove" button on each member (except themselves)
    - Remove calls API DELETE /teams/:id/members/:userId
    - Confirm dialog before removal

    **Create components/teams/invite-member-form.tsx:**
    - Client component
    - Fields: email (valid email), role dropdown (ADMIN/MANAGER/MEMBER, default MEMBER)
    - Validates with inviteMemberSchema
    - onSubmit calls API POST /teams/:id/members
    - Shows success/error toast

    **Create teams/page.tsx (team list):**
    - Server Component
    - Fetch user's teams from API
    - Display as cards: team name, member count, created date
    - "Create Team" button linking to /teams/new
    - Empty state: "No teams yet. Create your first team to get started."

    **Create teams/new/page.tsx:**
    - Renders TeamForm component
    - Page title: "Create a New Team"

    **Create teams/[teamId]/page.tsx (team overview):**
    - Server Component fetching team data
    - Team name and description at top
    - Member list component
    - "Invite Member" section (shown to admin/manager)
    - Link to team projects: /teams/[teamId]/projects
    - Link to team settings: /teams/[teamId]/settings

    **Create teams/[teamId]/settings/page.tsx:**
    - Team settings page (admin only)
    - Member management with invite form and member list (with remove buttons)
    - Could also show team name edit form (stretch, not required)
  </action>
  <verify>
    Navigate through pages:
    1. /teams shows team list (empty state if none)
    2. /teams/new shows create form, submit creates team
    3. /teams/[id] shows team overview with members
    4. /teams/[id]/settings shows member management (admin only)
    5. Invite member form works (needs second user in system)
    6. Remove member button visible only for admin
    7. Form validation works (empty name rejected)
  </verify>
  <done>Complete teams frontend: list, create, overview, member management. Forms validate with shared Zod schemas. Role-based UI (admin sees remove buttons, admin/manager see invite form).</done>
</task>

</tasks>

<verification>
1. Dashboard layout renders correctly with sidebar and header
2. Sidebar shows user's teams dynamically
3. All team pages navigate correctly
4. Team creation form validates and creates team via API
5. Member list displays with role badges
6. Invite and remove member functionality works
7. Mobile responsive layout works
</verification>

<success_criteria>
- TEAM-01: User can create a team (UI)
- TEAM-02: User can invite members (UI)
- TEAM-03: User can view team members and roles (UI)
- TEAM-04: Admin can remove members (UI)
- Dashboard layout ready for all subsequent frontend plans
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-work-management/02-05-SUMMARY.md`
</output>
