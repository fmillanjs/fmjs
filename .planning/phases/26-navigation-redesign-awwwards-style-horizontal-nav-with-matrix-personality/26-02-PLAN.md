---
phase: 26-navigation-redesign-awwwards-style-horizontal-nav-with-matrix-personality
plan: "02"
type: execute
wave: 2
depends_on:
  - "26-01"
files_modified:
  - apps/web/e2e/portfolio/navigation.spec.ts
autonomous: false
requirements:
  - UX-04

must_haves:
  truths:
    - "Lighthouse CI performance score is >= 0.90 on all five portfolio URLs after nav changes"
    - "Existing Playwright navigation tests all pass with the redesigned nav"
    - "A human observer confirms the green underline slides in on hover and the active page indicator is visible"
    - "A human observer confirms no purple color is present in the nav"
    - "A human observer confirms the nav renders correctly in Matrix theme (dark) and light mode"
  artifacts:
    - path: "apps/web/e2e/portfolio/navigation.spec.ts"
      provides: "Updated E2E tests that pass with the new nav structure"
  key_links:
    - from: "apps/web/e2e/portfolio/navigation.spec.ts"
      to: "apps/web/components/portfolio/nav.tsx"
      via: "Playwright role selectors targeting nav links by role and name"
      pattern: "getByRole.*link.*about|projects"
---

<objective>
Run the Lighthouse CI performance gate to confirm nav changes do not degrade performance, update E2E navigation tests if needed for the redesigned nav structure, and present a human verification checkpoint to visually confirm the UX-04 hover animation.

Purpose: Phase 26 ships only if the quality gate passes and a human confirms the animation looks correct. This is the same quality gate pattern established in Phase 25.

Output: lhci autorun results (all 5 URLs >= 0.90), passing Playwright tests, human approval of visual output.
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/26-navigation-redesign-awwwards-style-horizontal-nav-with-matrix-personality/26-01-SUMMARY.md
@apps/web/e2e/portfolio/navigation.spec.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run Playwright navigation E2E tests and fix any failures caused by nav structure changes</name>
  <files>apps/web/e2e/portfolio/navigation.spec.ts</files>
  <action>
Run the existing Playwright navigation tests:

```bash
cd /home/doctor/fernandomillan && npx playwright test apps/web/e2e/portfolio/navigation.spec.ts --project=chromium 2>&1 | tail -30
```

The current tests use role-based selectors (`getByRole('link', { name: /about/i })`) which are robust to HTML structure changes — they should pass without modification.

**If tests pass:** No changes to navigation.spec.ts needed. Document as confirmed.

**If tests fail** (e.g., a selector breaks due to the new `<span aria-hidden="true">` children inside links): Update the failing test selectors. The likely failure pattern is role selectors picking up the aria-hidden spans — but since those spans have `aria-hidden="true"`, they are excluded from the accessibility tree and should not affect `getByRole` selectors.

If the mobile navigation test (`mobile navigation works`) fails due to the menu button aria-label change, update the selector to match the current `aria-label="Toggle mobile menu"` on the Button component (unchanged in Plan 01).

Do NOT change test assertions — only fix selectors if role-based matching breaks. Tests should not be made less strict.
  </action>
  <verify>
Run: `npx playwright test apps/web/e2e/portfolio/navigation.spec.ts --project=chromium 2>&1 | grep -E "passed|failed|error"`

Expected: all tests passed, 0 failed.
  </verify>
  <done>
- All navigation.spec.ts tests pass (0 failures)
- If changes were needed to navigation.spec.ts, they are minimal selector fixes only — no test removals or weakened assertions
  </done>
</task>

<task type="auto">
  <name>Task 2: Run Lighthouse CI gate on all five portfolio URLs</name>
  <files></files>
  <action>
Run lhci autorun against the production build:

```bash
cd /home/doctor/fernandomillan/apps/web && npm run build 2>&1 | tail -20
```

If build succeeds, run lhci:

```bash
cd /home/doctor/fernandomillan/apps/web && npx lhci autorun 2>&1 | tail -40
```

The five URLs tested by lighthouserc.json are:
- http://localhost:3000/
- http://localhost:3000/projects
- http://localhost:3000/projects/teamflow
- http://localhost:3000/projects/devcollab
- http://localhost:3000/contact

**Acceptance threshold:** performance >= 0.90 on every URL. This matches the Phase 25 gate that passed at 0.99-1.00.

**If lhci fails to start Chrome:** Per Phase 23 STATE.md decision — use WSL2 Chromium path. The lighthouserc.json should already have the correct Chrome path from Phase 23.

**If a single URL scores 0.88-0.89:** This is within acceptable variance. Document the exact score. Only fail the gate if any URL is below 0.85.
  </action>
  <verify>
Parse lhci output: `npx lhci autorun 2>&1 | grep -E "performance|score|PASS|FAIL"`

Expected: All 5 URLs show performance score >= 0.90.
  </verify>
  <done>
- `npm run build` exits 0 (no build errors)
- lhci autorun reports performance >= 0.90 on all 5 URLs
- No new performance regression introduced by nav changes (nav is lightweight CSS + one tiny Motion span)
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Human verification of nav redesign (SC-1 through SC-5)</name>
  <action>Start the dev server and visually verify all five Phase 26 success criteria as specified in how-to-verify below.</action>
  <what-built>
Phase 26 complete nav redesign:
- UX-04: CSS scaleX sliding Matrix-green underline on desktop nav link hover (250ms ease-out, left-to-right)
- Motion layoutId="nav-active-underline" spring animation between active pages (stiffness 380, damping 30)
- Awwwards typography: tracking-wide on nav links, --matrix-green text color on active/hover
- Mobile: left-border accent (border-l-2 border-[--matrix-green]) on active link
- Reduced motion: CSS transition killed globally, Motion span conditionally rendered via useReducedMotion()
- No purple anywhere
  </what-built>
  <how-to-verify>
Start the dev server if not already running:
```bash
cd /home/doctor/fernandomillan && pnpm --filter web dev
```
Then open http://localhost:3000 in your browser.

**SC-1 — Hover underline:**
1. On a desktop viewport, hover over "About" in the nav
2. Confirm a thin green line slides in from left-to-right under the link text
3. Move cursor away — confirm the green line slides back out (right-to-left)
4. Repeat on "Projects", "Resume", "Contact"
Expected: Smooth 250ms slide animation, Matrix green color

**SC-2 — Active page indicator:**
1. You are on the home page — confirm "/" has a persistent green underline (not just on hover)
2. Click "About" — confirm the underline slides/springs from Home to About
3. Click "Projects" — confirm the underline slides to Projects
Expected: The underline persists on the current page and animates to the new page on navigation

**SC-3 — Typography:**
1. Inspect nav link text — confirm slightly wider letter spacing (tracking-wide) compared to body text
2. Confirm active and hovered links show Matrix green (#00FF41) not blue
Expected: Refined, slightly editorial spacing; green is the only accent color

**SC-4 — Mobile:**
1. Resize browser to mobile width (< 768px) or use DevTools mobile emulation
2. Open the hamburger menu
3. Confirm the current/active page link shows a left-side green border accent (not a blue background highlight)
4. Confirm other links show normal muted text
Expected: Left-border green accent on active mobile link

**SC-5 — No purple:**
1. Scan the entire nav (desktop and mobile) visually
2. Confirm zero purple elements anywhere
Expected: Only green (#00FF41), muted gray/white text, and transparent backgrounds

**SC-6 — Reduced motion (optional, if you can toggle OS setting):**
1. Toggle "Reduce motion" in your OS accessibility settings
2. Reload http://localhost:3000
3. Hover nav links — confirm no underline animation (it may appear instantly or not at all)
4. Navigate between pages — confirm no spring animation on active underline
Expected: Instant state changes, no CSS transitions or Motion animations
  </how-to-verify>
  <resume-signal>Type "approved" if all SC-1 through SC-5 pass, or describe any issues found (SC-6 is optional)</resume-signal>
</task>

</tasks>

<verification>
Phase 26 is complete when:
1. All Playwright navigation tests pass (0 failures)
2. lhci autorun reports >= 0.90 performance on all 5 URLs
3. Human verifies SC-1 through SC-5 and types "approved"
</verification>

<success_criteria>
- Playwright: 0 test failures in navigation.spec.ts
- Lighthouse: performance >= 0.90 on /, /projects, /projects/teamflow, /projects/devcollab, /contact
- Human: SC-1 hover underline confirmed, SC-2 active indicator confirmed, SC-3 typography confirmed, SC-4 mobile left-border confirmed, SC-5 no purple confirmed
- Phase 26 requirement UX-04 delivered end-to-end
</success_criteria>

<output>
After completion, create `.planning/phases/26-navigation-redesign-awwwards-style-horizontal-nav-with-matrix-personality/26-02-SUMMARY.md` with:
- Playwright test results (pass/fail counts, any fixes made)
- lhci scores for all 5 URLs
- Human verification outcome (approved / issues found)
- Phase 26 status: COMPLETE or NEEDS REWORK
</output>
