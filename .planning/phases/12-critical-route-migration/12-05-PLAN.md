---
phase: 12-critical-route-migration
plan: 05
type: execute
wave: 2
depends_on:
  - 12-01
files_modified:
  - apps/web/components/tasks/task-card.tsx
  - apps/web/components/tasks/kanban-column.tsx
autonomous: true
requirements:
  - MIG-02
  - MIG-03

must_haves:
  truths:
    - "TaskCard priority and status labels use Shadcn Badge instead of inline <span> elements"
    - "KanbanColumn uses Shadcn Card as outer container"
    - "dnd-kit droppable ref (setNodeRef) remains on the inner div, not moved to Card"
    - "isDragging opacity behavior preserved on TaskCard"
    - "Old inline <span> badge elements deleted from task-card.tsx"
  artifacts:
    - path: "apps/web/components/tasks/task-card.tsx"
      provides: "Task card with Badge for priority/status labels"
      contains: "Badge"
    - path: "apps/web/components/tasks/kanban-column.tsx"
      provides: "Column container using Shadcn Card"
      contains: "Card"
  key_links:
    - from: "apps/web/components/tasks/kanban-column.tsx"
      to: "@/components/ui/card"
      via: "import"
      pattern: "from '@/components/ui/card'"
    - from: "apps/web/components/tasks/task-card.tsx"
      to: "@/components/ui/badge"
      via: "import"
      pattern: "from '@/components/ui/badge'"
    - from: "apps/web/components/tasks/kanban-column.tsx"
      to: "useDroppable"
      via: "setNodeRef on inner div"
      pattern: "ref=\\{setNodeRef\\}"
---

<objective>
Migrate TaskCard inline badge spans to Shadcn Badge, and KanbanColumn outer div to Shadcn Card. These are visual-only changes — dnd-kit drag-and-drop logic is UNTOUCHED in both components.

Purpose: MIG-02 + MIG-03 — eliminate manual inline <span> pill classes and raw div column containers. Consistent Badge variant API, Card design tokens.
Output: task-card.tsx uses Badge for priority and status. kanban-column.tsx uses Card as outer container with the droppable setNodeRef preserved on the inner div.
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/12-critical-route-migration/12-RESEARCH.md
@apps/web/components/tasks/task-card.tsx
@apps/web/components/tasks/kanban-column.tsx
@apps/web/components/ui/badge.tsx
@apps/web/components/ui/card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace inline badge spans in task-card.tsx with Shadcn Badge</name>
  <files>apps/web/components/tasks/task-card.tsx</files>
  <action>
    Replace the two inline `<span>` priority/status badge elements with Shadcn Badge.

    1. Add import:
       ```tsx
       import { Badge } from '@/components/ui/badge';
       import { cn } from '@/lib/utils';
       ```

    2. Replace the priority badge span (currently: `<span className={`text-xs font-medium px-2 py-0.5 rounded ${priorityColor.bg} ${priorityColor.text}`}>`):
       ```tsx
       <Badge
         variant="outline"
         className={cn('border-0 text-xs font-medium', priorityColor.bg, priorityColor.text)}
       >
         {task.priority}
       </Badge>
       ```

    3. Replace the status badge span (currently: `<span className={`text-xs px-2 py-0.5 rounded ${statusColor.bg} ${statusColor.text}`}>`):
       ```tsx
       <Badge
         variant="outline"
         className={cn('border-0 text-xs', statusColor.bg, statusColor.text)}
       >
         {statusLabels[task.status]}
       </Badge>
       ```

    The outer card `<div>` with `bg-card rounded-lg border-2` and the `isDragging` opacity logic are UNTOUCHED. The dnd-kit wiring in sortable-task-card.tsx is not changed by this plan.

    Note: Using `variant="outline"` with `className` override preserves the CVA Badge base styles while applying Radix Color tokens. `cn()` handles class merging.
  </action>
  <verify>
    `grep "text-xs font-medium px-2 py-0.5 rounded" apps/web/components/tasks/task-card.tsx` returns empty (old spans deleted).
    `grep "Badge" apps/web/components/tasks/task-card.tsx` returns import and 2 usages.
    `npx tsc --noEmit` passes.
  </verify>
  <done>TaskCard uses Shadcn Badge for priority and status labels. Old inline span elements deleted. isDragging and dnd-kit props unchanged.</done>
</task>

<task type="auto">
  <name>Task 2: Wrap KanbanColumn outer container in Shadcn Card</name>
  <files>apps/web/components/tasks/kanban-column.tsx</files>
  <action>
    Replace the outer `<div className="flex flex-col bg-muted rounded-lg p-4 min-h-[500px]">` with Shadcn Card.

    1. Add imports:
       ```tsx
       import { Card, CardHeader, CardContent } from '@/components/ui/card';
       ```

    2. Replace the outer div with Card:
       ```tsx
       <Card className="flex flex-col min-h-[500px]">
         <CardHeader className="pb-2">
           <div className="flex items-center justify-between">
             <h3 className="font-semibold text-foreground text-sm">
               {title}
               <span className="ml-2 font-normal text-muted-foreground">({count})</span>
             </h3>
             <button
               onClick={onAddTask}
               className="text-primary hover:text-primary/80 text-sm font-medium"
             >
               + Add
             </button>
           </div>
         </CardHeader>
         <CardContent className="flex-1 pt-0">
           {/* droppable area — UNCHANGED */}
           <div
             ref={setNodeRef}
             className={`
               flex-1 space-y-3 rounded-lg transition-colors
               ${isOver ? 'bg-accent border-2 border-primary/30 border-dashed' : 'border-2 border-transparent'}
               ${tasks.length === 0 ? 'border-2 border-dashed border-border flex items-center justify-center' : ''}
             `}
           >
             <SortableContext items={tasks.map((t) => t.id)} strategy={verticalListSortingStrategy}>
               {tasks.length === 0 ? (
                 <p className="text-muted-foreground text-sm">Drop tasks here</p>
               ) : (
                 tasks.map((task) => (
                   <SortableTaskCard key={task.id} task={task} onClick={() => onTaskClick(task)} />
                 ))
               )}
             </SortableContext>
           </div>
         </CardContent>
       </Card>
       ```

    CRITICAL: The `ref={setNodeRef}` from `useDroppable` MUST remain on the inner div, not moved to the Card component. Moving it to Card would break drag detection.

    Also verify that the `isOver` visual feedback still works — the inner div's conditional border class should remain exactly as-is.
  </action>
  <verify>
    `grep "bg-muted rounded-lg p-4" apps/web/components/tasks/kanban-column.tsx` returns empty (old outer div deleted).
    `grep "Card\|CardHeader\|CardContent" apps/web/components/tasks/kanban-column.tsx` returns matches.
    `grep "ref={setNodeRef}" apps/web/components/tasks/kanban-column.tsx` returns a match (droppable ref preserved on inner div).
    `npx tsc --noEmit` passes.
  </verify>
  <done>KanbanColumn uses Shadcn Card as outer container. setNodeRef from useDroppable remains on the inner droppable div. Column header uses CardHeader. Old outer div deleted.</done>
</task>

</tasks>

<verification>
1. `grep "text-xs font-medium px-2 py-0.5 rounded" apps/web/components/tasks/task-card.tsx` returns empty
2. `grep "bg-muted rounded-lg p-4" apps/web/components/tasks/kanban-column.tsx` returns empty
3. `grep "ref={setNodeRef}" apps/web/components/tasks/kanban-column.tsx` returns a match (dnd still wired)
4. `npx tsc --noEmit` passes
</verification>

<success_criteria>
TaskCard uses Badge for labels. KanbanColumn uses Card as its outer container. dnd-kit drag-and-drop functionality is completely unchanged. All old raw elements deleted.
</success_criteria>

<output>
After completion, create `.planning/phases/12-critical-route-migration/12-05-SUMMARY.md`
</output>
