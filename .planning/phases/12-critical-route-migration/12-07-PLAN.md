---
phase: 12-critical-route-migration
plan: 07
type: execute
wave: 2
depends_on:
  - 12-01
files_modified:
  - apps/web/components/projects/project-card.tsx
  - apps/web/components/projects/project-list.tsx
  - apps/web/components/projects/project-actions.tsx
autonomous: true
requirements:
  - COMP-04
  - MIG-02
  - MIG-03

must_haves:
  truths:
    - "ProjectCard uses Shadcn Card as its outer container"
    - "ProjectCard status label uses Shadcn Badge"
    - "ProjectList filter tabs use Shadcn Tabs (not manual border-b buttons)"
    - "ProjectList filter useState is deleted (Tabs manages state)"
    - "ProjectActions archive confirmation uses AlertDialog"
    - "ProjectActions delete confirmation uses controlled Dialog with Input for name verification"
    - "showArchiveConfirm and showDeleteConfirm states deleted from project-actions.tsx"
    - "Old inline confirm divs deleted from project-actions.tsx"
  artifacts:
    - path: "apps/web/components/projects/project-card.tsx"
      provides: "Project card using Shadcn Card with Badge status label"
      contains: "Card"
    - path: "apps/web/components/projects/project-list.tsx"
      provides: "Project list with Shadcn Tabs filter"
      contains: "Tabs"
    - path: "apps/web/components/projects/project-actions.tsx"
      provides: "Archive (AlertDialog) and delete (controlled Dialog with Input) confirmation flows"
      contains: "AlertDialogTrigger"
  key_links:
    - from: "apps/web/components/projects/project-actions.tsx"
      to: "handleArchive"
      via: "AlertDialogAction onClick"
      pattern: "onClick.*handleArchive"
    - from: "apps/web/components/projects/project-actions.tsx"
      to: "handleDelete"
      via: "Dialog Button onClick"
      pattern: "onClick.*handleDelete"
---

<objective>
Migrate three project components to Shadcn: ProjectCard (raw div to Card, status span to Badge), ProjectList (manual tab buttons to Tabs), and ProjectActions (inline confirm divs to AlertDialog for archive, controlled Dialog for delete with name confirmation). ProjectActions is the most complex — archive uses AlertDialog (simple yes/no), but delete requires a controlled Dialog because it contains a text Input.

Purpose: MIG-02 + MIG-03 + COMP-04. Completes the project management side of the migration.
Output: All three project components use Shadcn primitives. All old confirm divs and manual tab buttons deleted.
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/12-critical-route-migration/12-RESEARCH.md
@apps/web/components/projects/project-card.tsx
@apps/web/components/projects/project-list.tsx
@apps/web/components/projects/project-actions.tsx
@apps/web/components/ui/card.tsx
@apps/web/components/ui/tabs.tsx
@apps/web/components/ui/alert-dialog.tsx
@apps/web/components/ui/dialog.tsx
@apps/web/components/ui/badge.tsx
@apps/web/components/ui/button.tsx
@apps/web/components/ui/input.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate project-card.tsx and project-list.tsx to Card, Badge, and Tabs</name>
  <files>
    apps/web/components/projects/project-card.tsx
    apps/web/components/projects/project-list.tsx
  </files>
  <action>
    ### project-card.tsx

    1. Add imports:
       ```tsx
       import { Card, CardContent } from '@/components/ui/card';
       import { Badge } from '@/components/ui/badge';
       import { cn } from '@/lib/utils';
       ```

    2. Replace the outer `<Link>` wrapper — the Link navigates to the project, and it wraps the whole card. Card must be a child of Link:
       ```tsx
       <Link href={`/teams/${teamId}/projects/${project.id}`} className="block group">
         <Card className="hover:shadow-lg transition-shadow duration-200">
           <CardContent className="p-6">
             <div className="flex items-start justify-between mb-3">
               <h3 className="text-lg font-semibold text-foreground line-clamp-1">
                 {project.name}
               </h3>
               <Badge
                 variant="outline"
                 className={cn('border-0 ml-2 shrink-0', statusColor)}
               >
                 {project.status}
               </Badge>
             </div>
             {project.description && (
               <p className="text-sm text-muted-foreground mb-4 line-clamp-2">
                 {project.description}
               </p>
             )}
             <div className="flex items-center justify-between text-xs text-muted-foreground">
               <span>{project._count?.tasks ?? 0} {(project._count?.tasks ?? 0) === 1 ? 'task' : 'tasks'}</span>
               <span>Created {formatDistanceToNow(new Date(project.createdAt), { addSuffix: true })}</span>
             </div>
           </CardContent>
         </Card>
       </Link>
       ```
       Update `statusColor` to be a string className: `const statusColor = project.status === 'ACTIVE' ? 'bg-[var(--green-3)] text-[var(--green-11)]' : 'bg-muted text-muted-foreground';`
       (Already a string — just pass directly to `cn()`)

    ### project-list.tsx

    1. Add imports:
       ```tsx
       import { Tabs, TabsList, TabsTrigger, TabsContent } from '@/components/ui/tabs';
       ```

    2. Remove the `filter` state and `setFilter` function:
       Delete: `const [filter, setFilter] = useState<FilterStatus>('ACTIVE');`

    3. Remove the `filteredProjects` derived state — Tabs manages which content is shown.

    4. Replace the entire component return:
       ```tsx
       return (
         <Tabs defaultValue="ACTIVE">
           <TabsList className="w-full justify-start rounded-none h-auto bg-transparent border-b px-0 gap-6">
             <TabsTrigger
               value="ACTIVE"
               className="rounded-none border-b-2 border-transparent data-[state=active]:border-primary data-[state=active]:shadow-none data-[state=active]:bg-transparent pb-2 px-1"
             >
               Active ({activeCount})
             </TabsTrigger>
             <TabsTrigger
               value="ARCHIVED"
               className="rounded-none border-b-2 border-transparent data-[state=active]:border-primary data-[state=active]:shadow-none data-[state=active]:bg-transparent pb-2 px-1"
             >
               Archived ({archivedCount})
             </TabsTrigger>
             <TabsTrigger
               value="ALL"
               className="rounded-none border-b-2 border-transparent data-[state=active]:border-primary data-[state=active]:shadow-none data-[state=active]:bg-transparent pb-2 px-1"
             >
               All ({projects.length})
             </TabsTrigger>
           </TabsList>

           <TabsContent value="ACTIVE" className="mt-4">
             {projects.filter(p => p.status === 'ACTIVE').length === 0 ? (
               <div className="text-center py-12"><p className="text-muted-foreground">No active projects. Create one to get started.</p></div>
             ) : (
               <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                 {projects.filter(p => p.status === 'ACTIVE').map(project => <ProjectCard key={project.id} project={project} teamId={teamId} />)}
               </div>
             )}
           </TabsContent>

           <TabsContent value="ARCHIVED" className="mt-4">
             {projects.filter(p => p.status === 'ARCHIVED').length === 0 ? (
               <div className="text-center py-12"><p className="text-muted-foreground">No archived projects.</p></div>
             ) : (
               <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                 {projects.filter(p => p.status === 'ARCHIVED').map(project => <ProjectCard key={project.id} project={project} teamId={teamId} />)}
               </div>
             )}
           </TabsContent>

           <TabsContent value="ALL" className="mt-4">
             {projects.length === 0 ? (
               <div className="text-center py-12"><p className="text-muted-foreground">No projects found.</p></div>
             ) : (
               <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                 {projects.map(project => <ProjectCard key={project.id} project={project} teamId={teamId} />)}
               </div>
             )}
           </TabsContent>
         </Tabs>
       );
       ```
       Keep `activeCount` and `archivedCount` calculations.
  </action>
  <verify>
    `grep "block p-6 bg-card rounded-lg border" apps/web/components/projects/project-card.tsx` returns empty (old outer div deleted).
    `grep "filter.*ACTIVE\|setFilter\|border-b-2.*font-medium" apps/web/components/projects/project-list.tsx` returns empty (old tab buttons + state deleted).
    `grep "TabsContent\|TabsTrigger" apps/web/components/projects/project-list.tsx` returns matches.
    `npx tsc --noEmit` passes.
  </verify>
  <done>ProjectCard uses Card + Badge. ProjectList uses Tabs for filtering. Old raw div card and border-b tab buttons deleted. TypeScript passes.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate project-actions.tsx to AlertDialog (archive) and controlled Dialog (delete)</name>
  <files>apps/web/components/projects/project-actions.tsx</files>
  <action>
    Replace both inline confirm patterns. Archive = AlertDialog (simple yes/no). Delete = controlled Dialog with Input (requires text input inside, AlertDialog does not support this).

    1. Add imports:
       ```tsx
       import { useState } from 'react'; // keep existing
       import {
         AlertDialog, AlertDialogAction, AlertDialogCancel,
         AlertDialogContent, AlertDialogDescription, AlertDialogFooter,
         AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger,
       } from '@/components/ui/alert-dialog';
       import {
         Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter,
       } from '@/components/ui/dialog';
       import { Button } from '@/components/ui/button';
       import { Input } from '@/components/ui/input';
       ```

    2. Remove `showArchiveConfirm` and `showDeleteConfirm` states entirely.

    3. Add `confirmName` state for delete input: `const [confirmName, setConfirmName] = useState('');`
    4. Add `deleteOpen` state: `const [deleteOpen, setDeleteOpen] = useState(false);`

    5. Replace Archive section:
       ```tsx
       {projectStatus === 'ACTIVE' && (
         <div className="border-b border-border pb-4">
           <h3 className="text-sm font-medium text-foreground mb-2">Archive Project</h3>
           <p className="text-sm text-muted-foreground mb-3">
             Archiving this project will hide it from the active projects list. You can unarchive it later.
           </p>
           <AlertDialog>
             <AlertDialogTrigger asChild>
               <Button
                 variant="outline"
                 className="text-[var(--amber-11)] border-[var(--amber-6)] bg-[var(--amber-3)] hover:bg-[var(--amber-4)]"
                 disabled={isArchiving}
               >
                 {isArchiving ? 'Archiving...' : 'Archive Project'}
               </Button>
             </AlertDialogTrigger>
             <AlertDialogContent>
               <AlertDialogHeader>
                 <AlertDialogTitle>Archive this project?</AlertDialogTitle>
                 <AlertDialogDescription>
                   "{projectName}" will be hidden from the active projects list. You can unarchive it from the Archived tab later.
                 </AlertDialogDescription>
               </AlertDialogHeader>
               <AlertDialogFooter>
                 <AlertDialogCancel>Cancel</AlertDialogCancel>
                 <AlertDialogAction onClick={handleArchive} disabled={isArchiving}>
                   {isArchiving ? 'Archiving...' : 'Yes, Archive'}
                 </AlertDialogAction>
               </AlertDialogFooter>
             </AlertDialogContent>
           </AlertDialog>
         </div>
       )}
       ```

    6. Replace Delete section with controlled Dialog (NOT AlertDialog — needs Input inside):
       ```tsx
       {isAdmin && (
         <div>
           <h3 className="text-sm font-medium text-[var(--red-11)] mb-2">Delete Project</h3>
           <p className="text-sm text-muted-foreground mb-3">
             Permanently delete this project and all its tasks. This action cannot be undone.
           </p>
           <Button
             variant="destructive"
             onClick={() => { setDeleteOpen(true); setConfirmName(''); }}
           >
             Delete Project
           </Button>
           <Dialog open={deleteOpen} onOpenChange={setDeleteOpen}>
             <DialogContent>
               <DialogHeader>
                 <DialogTitle className="text-destructive">Delete Project</DialogTitle>
                 <DialogDescription>
                   This action cannot be undone. Type <strong>{projectName}</strong> to confirm deletion.
                 </DialogDescription>
               </DialogHeader>
               <Input
                 value={confirmName}
                 onChange={(e) => setConfirmName(e.target.value)}
                 placeholder="Type project name to confirm"
                 className="mt-2"
               />
               <DialogFooter className="mt-4">
                 <Button variant="outline" onClick={() => setDeleteOpen(false)}>Cancel</Button>
                 <Button
                   variant="destructive"
                   disabled={confirmName !== projectName || isDeleting}
                   onClick={handleDelete}
                 >
                   {isDeleting ? 'Deleting...' : 'Delete Forever'}
                 </Button>
               </DialogFooter>
             </DialogContent>
           </Dialog>
         </div>
       )}
       ```

    Delete: `showArchiveConfirm` state, `showDeleteConfirm` state, both old confirm div blocks, the `document.getElementById('confirm-delete-btn')` DOM manipulation (replace with `confirmName` controlled state), and the `id="confirm-delete-btn"` button.

    The `handleArchive` and `handleDelete` API fetch functions are UNCHANGED.
  </action>
  <verify>
    `grep "showArchiveConfirm\|showDeleteConfirm\|getElementById" apps/web/components/projects/project-actions.tsx` returns empty.
    `grep "AlertDialogTrigger\|DialogContent" apps/web/components/projects/project-actions.tsx` returns matches.
    `grep "confirmName" apps/web/components/projects/project-actions.tsx` returns matches (new controlled delete state).
    `npx tsc --noEmit` passes.
  </verify>
  <done>ProjectActions uses AlertDialog for archive confirmation and controlled Dialog with Input for delete confirmation. showArchiveConfirm, showDeleteConfirm, and DOM manipulation deleted. API logic unchanged.</done>
</task>

</tasks>

<verification>
1. `grep "showArchiveConfirm\|showDeleteConfirm\|getElementById" apps/web/components/projects/project-actions.tsx` returns empty
2. `grep "AlertDialogContent\|DialogContent" apps/web/components/projects/project-actions.tsx` returns 2 matches
3. `grep "border-b-2.*font-medium.*py-2" apps/web/components/projects/project-list.tsx` returns empty (old tab buttons gone)
4. `npx tsc --noEmit` passes for all three files
</verification>

<success_criteria>
All three project components migrated to Shadcn. ProjectCard uses Card + Badge. ProjectList uses Tabs. ProjectActions uses AlertDialog (archive) + controlled Dialog (delete). All old confirm divs and raw tab buttons deleted. COMP-04 satisfied for project confirmation flows.
</success_criteria>

<output>
After completion, create `.planning/phases/12-critical-route-migration/12-07-SUMMARY.md`
</output>
