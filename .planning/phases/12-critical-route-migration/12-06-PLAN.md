---
phase: 12-critical-route-migration
plan: 06
type: execute
wave: 2
depends_on:
  - 12-01
files_modified:
  - apps/web/components/teams/team-member-list.tsx
autonomous: true
requirements:
  - COMP-04
  - MIG-02
  - MIG-03

must_haves:
  truths:
    - "Remove member button opens an AlertDialog confirmation (not an inline div)"
    - "AlertDialog has role='alertdialog' (automatic via Radix)"
    - "ESC key closes the AlertDialog"
    - "showConfirm state is deleted from team-member-list.tsx"
    - "Role badges use Shadcn Badge"
    - "Old inline confirm div (showConfirm conditional) is deleted"
  artifacts:
    - path: "apps/web/components/teams/team-member-list.tsx"
      provides: "Member list with AlertDialog remove confirmation and Badge role labels"
      contains: "AlertDialogTrigger"
  key_links:
    - from: "apps/web/components/teams/team-member-list.tsx"
      to: "@/components/ui/alert-dialog"
      via: "import"
      pattern: "from '@/components/ui/alert-dialog'"
    - from: "apps/web/components/teams/team-member-list.tsx"
      to: "handleRemove"
      via: "AlertDialogAction onClick"
      pattern: "onClick.*handleRemove"
---

<objective>
Migrate TeamMemberList from inline confirm divs (showConfirm state) to Shadcn AlertDialog for the remove member confirmation. Replace role badge spans with Shadcn Badge. This satisfies COMP-04 for the team management UI.

Purpose: MIG-02 + MIG-03 + COMP-04. AlertDialog provides role="alertdialog" which causes screen readers to interrupt and announce the confirmation message. The old inline confirm div has no ARIA announcement.
Output: team-member-list.tsx uses AlertDialog wrapping each Remove button. showConfirm state deleted. Role badges use Shadcn Badge. Old confirm div deleted.
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/12-critical-route-migration/12-RESEARCH.md
@apps/web/components/teams/team-member-list.tsx
@apps/web/components/ui/alert-dialog.tsx
@apps/web/components/ui/badge.tsx
@apps/web/components/ui/button.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace inline confirm div with AlertDialog and role badge spans with Badge</name>
  <files>apps/web/components/teams/team-member-list.tsx</files>
  <action>
    Replace the showConfirm inline confirm pattern with AlertDialog, and upgrade role badge spans to Shadcn Badge.

    1. Add imports:
       ```tsx
       import {
         AlertDialog, AlertDialogAction, AlertDialogCancel,
         AlertDialogContent, AlertDialogDescription, AlertDialogFooter,
         AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger,
       } from '@/components/ui/alert-dialog';
       import { Badge } from '@/components/ui/badge';
       import { Button } from '@/components/ui/button';
       ```

    2. Remove the `showConfirm` state entirely:
       Delete: `const [showConfirm, setShowConfirm] = useState<string | null>(null);`

    3. In `handleRemove`, remove `setShowConfirm(null)` from the success path — AlertDialog closes automatically after the action.

    4. Replace the entire Remove section in the member row (currently the conditional `{showConfirm === member.userId ? ... : ...}` block) with AlertDialog:
       ```tsx
       {canRemove && member.userId !== currentUserId && (
         <div className="ml-4">
           <AlertDialog>
             <AlertDialogTrigger asChild>
               <Button
                 variant="ghost"
                 size="sm"
                 className="text-[var(--red-11)] hover:text-[var(--red-12)] hover:bg-[var(--red-3)]"
                 disabled={removingId === member.userId}
               >
                 {removingId === member.userId ? 'Removing...' : 'Remove'}
               </Button>
             </AlertDialogTrigger>
             <AlertDialogContent>
               <AlertDialogHeader>
                 <AlertDialogTitle>Remove team member?</AlertDialogTitle>
                 <AlertDialogDescription>
                   {member.user.name || member.user.email} will lose access to this team immediately. This action cannot be undone.
                 </AlertDialogDescription>
               </AlertDialogHeader>
               <AlertDialogFooter>
                 <AlertDialogCancel>Cancel</AlertDialogCancel>
                 <AlertDialogAction
                   className="bg-destructive text-destructive-foreground hover:bg-destructive/90"
                   onClick={() => handleRemove(member.userId)}
                   disabled={removingId === member.userId}
                 >
                   Remove
                 </AlertDialogAction>
               </AlertDialogFooter>
             </AlertDialogContent>
           </AlertDialog>
         </div>
       )}
       ```

    5. Replace the role badge span (currently `<span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getRoleBadgeColor(member.role)}`}>`):
       ```tsx
       <Badge
         variant="outline"
         className={cn('border-0 rounded-full text-xs', getRoleBadgeColor(member.role))}
       >
         {member.role}
       </Badge>
       ```
       Add `import { cn } from '@/lib/utils';` if not already imported.

    6. Replace the "You" indicator span with Badge:
       ```tsx
       <Badge variant="secondary" className="text-xs">You</Badge>
       ```

    The `handleRemove` API call logic is UNCHANGED. The `removingId` state is kept — it drives the loading state on the AlertDialogAction button.
  </action>
  <verify>
    `grep "showConfirm" apps/web/components/teams/team-member-list.tsx` returns empty.
    `grep "AlertDialogTrigger\|AlertDialogContent" apps/web/components/teams/team-member-list.tsx` returns matches.
    `grep "inline-flex items-center px-2.5" apps/web/components/teams/team-member-list.tsx` returns empty (old badge span deleted).
    `npx tsc --noEmit` passes.
  </verify>
  <done>TeamMemberList uses AlertDialog for remove confirmation. showConfirm state deleted. Role badges use Shadcn Badge. Old inline confirm div deleted. handleRemove API logic unchanged.</done>
</task>

</tasks>

<verification>
1. `grep "showConfirm" apps/web/components/teams/team-member-list.tsx` returns empty
2. `grep "AlertDialogContent" apps/web/components/teams/team-member-list.tsx` returns a match
3. `grep "inline-flex.*rounded-full" apps/web/components/teams/team-member-list.tsx` returns empty
4. `npx tsc --noEmit` passes
</verification>

<success_criteria>
TeamMemberList uses AlertDialog for destructive remove confirmation. Role badges use Shadcn Badge. All old inline confirm div code deleted. MIG-03 satisfied for this file. COMP-04 satisfied for this component.
</success_criteria>

<output>
After completion, create `.planning/phases/12-critical-route-migration/12-06-SUMMARY.md`
</output>
