---
phase: 04-portfolio-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/app/not-found.tsx
  - apps/web/app/error.tsx
  - apps/web/app/global-error.tsx
  - apps/web/app/(dashboard)/loading.tsx
  - apps/web/app/(dashboard)/teams/loading.tsx
  - apps/web/app/(dashboard)/teams/[teamId]/loading.tsx
  - apps/web/app/(dashboard)/teams/[teamId]/projects/[projectId]/loading.tsx
  - apps/web/components/ui/skeleton.tsx
  - apps/web/components/ui/empty-state.tsx
autonomous: true

must_haves:
  truths:
    - "Visiting a non-existent URL shows a styled 404 page with navigation options"
    - "An unhandled error in any route shows a styled error page with retry button"
    - "Dashboard pages show skeleton loading states during data fetch"
    - "Pages with no data show empty state messages with guidance"
  artifacts:
    - path: "apps/web/app/not-found.tsx"
      provides: "Global 404 error page"
    - path: "apps/web/app/error.tsx"
      provides: "Global error boundary with retry"
    - path: "apps/web/app/global-error.tsx"
      provides: "Root error boundary for layout crashes"
    - path: "apps/web/components/ui/skeleton.tsx"
      provides: "Reusable skeleton loading component"
    - path: "apps/web/components/ui/empty-state.tsx"
      provides: "Reusable empty state component"
  key_links:
    - from: "apps/web/app/not-found.tsx"
      to: "/"
      via: "Link navigation for recovery"
      pattern: "Link.*href.*/"
    - from: "apps/web/app/error.tsx"
      to: "reset()"
      via: "Error boundary reset function"
      pattern: "reset\\(\\)"
---

<objective>
Add global error pages (404, 500) and loading/empty state infrastructure across the application.

Purpose: Professional applications need graceful error handling and loading states. These components will be used by both portfolio and dashboard routes.
Output: Global error pages, skeleton component, empty state component, loading states for all dashboard routes.
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-portfolio-polish/04-RESEARCH.md
@apps/web/app/layout.tsx
@apps/web/app/(dashboard)/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Global Error Pages (404, 500, Global Error)</name>
  <files>
    apps/web/app/not-found.tsx
    apps/web/app/error.tsx
    apps/web/app/global-error.tsx
  </files>
  <action>
    Create three error handling pages following Next.js App Router conventions:

    1. **not-found.tsx** (global 404):
       - Server Component (no 'use client')
       - Large "404" heading with primary color
       - "Page Not Found" subheading
       - Descriptive message: "The page you're looking for doesn't exist or has been moved."
       - Two buttons: "Go Home" (Link to /) and "View Projects" (Link to /projects)
       - Centered layout with min-h-screen, flex column, items-center, justify-center
       - Use Tailwind dark mode classes (dark:text-*, dark:bg-*)

    2. **error.tsx** (route error boundary):
       - Client Component ('use client' required by Next.js)
       - Receives `error` and `reset` props
       - Shows error.message (or generic fallback)
       - "Try Again" button calling `reset()`
       - "Go Home" link as fallback
       - Log error to console in useEffect for debugging
       - Centered layout matching not-found.tsx style

    3. **global-error.tsx** (root layout error boundary):
       - Client Component ('use client' required)
       - Must include its own `<html>` and `<body>` tags (replaces root layout)
       - Minimal styling (can't rely on globals.css if layout crashed)
       - "Something went wrong" message with "Try Again" button
       - Include basic inline styles as fallback

    Style all pages to work in both light and dark mode using Tailwind classes.
    Use lucide-react icons where appropriate (AlertTriangle for errors, FileQuestion for 404).
    NO purple colors.
  </action>
  <verify>
    - `apps/web/app/not-found.tsx` exists and is a Server Component (no 'use client')
    - `apps/web/app/error.tsx` exists and has 'use client' directive
    - `apps/web/app/global-error.tsx` exists with 'use client' and includes `<html>` and `<body>`
    - `npm run build --filter=web` succeeds
    - All error pages include dark mode Tailwind classes
  </verify>
  <done>
    Visiting /nonexistent-page shows styled 404 page. Error boundaries catch and display errors gracefully. Global error boundary handles root layout crashes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Skeleton, Empty State Components, and Dashboard Loading States</name>
  <files>
    apps/web/components/ui/skeleton.tsx
    apps/web/components/ui/empty-state.tsx
    apps/web/app/(dashboard)/loading.tsx
    apps/web/app/(dashboard)/teams/loading.tsx
    apps/web/app/(dashboard)/teams/[teamId]/loading.tsx
    apps/web/app/(dashboard)/teams/[teamId]/projects/[projectId]/loading.tsx
  </files>
  <action>
    Create reusable UI components and loading states for all dashboard routes:

    1. **Skeleton component** (apps/web/components/ui/skeleton.tsx):
       - Simple div with `animate-pulse` and rounded background
       - Accept `className` prop for sizing (h-4, w-full, etc.)
       - Use `bg-gray-200 dark:bg-gray-700` for the pulse color
       - Export as named export `Skeleton`

    2. **Empty state component** (apps/web/components/ui/empty-state.tsx):
       - Accept props: `icon` (LucideIcon), `title`, `description`, `action` (optional ReactNode for CTA button)
       - Centered layout with icon, title text, description text, and optional action
       - Use `text-muted-foreground` for description
       - Icon rendered at 48x48 with muted color

    3. **Dashboard loading states** (loading.tsx files):
       For each route segment, create a loading.tsx that mimics the page's layout:

       - `(dashboard)/loading.tsx`: Full page skeleton with sidebar placeholder and main content area skeleton
       - `(dashboard)/teams/loading.tsx`: Grid of team card skeletons (3 cards, each with name/member count)
       - `(dashboard)/teams/[teamId]/loading.tsx`: Team header skeleton + member list skeletons (5 rows)
       - `(dashboard)/teams/[teamId]/projects/[projectId]/loading.tsx`: Project header skeleton + Kanban column skeletons (4 columns with 3 card skeletons each)

    Each loading.tsx should:
    - Import and use the Skeleton component
    - Match the approximate dimensions of the real content
    - Be a Server Component (default, no directive needed)
    - Work in both light and dark mode
  </action>
  <verify>
    - Skeleton component renders with animate-pulse class
    - Empty state component renders icon, title, description
    - All 4 loading.tsx files exist in correct directories
    - `npm run build --filter=web` succeeds
    - Loading states use Skeleton component (grep for import)
  </verify>
  <done>
    Every dashboard route segment has a loading.tsx showing content-shaped skeletons during data fetch. Empty state component is available for use in pages with no data. Both components support dark mode.
  </done>
</task>

</tasks>

<verification>
- Navigate to /any-nonexistent-path â†’ shows styled 404 page
- Error boundary displays when a component throws
- Dashboard routes show skeleton loading states during navigation
- Skeleton component has animate-pulse animation
- Empty state component renders with icon, title, description
- All components work in both light and dark mode
- `npm run build --filter=web` succeeds
</verification>

<success_criteria>
Global 404 and 500 error pages exist with professional styling. Every dashboard route has loading.tsx with appropriate skeletons. Reusable Skeleton and EmptyState components are available for all future pages.
</success_criteria>

<output>
After completion, create `.planning/phases/04-portfolio-polish/04-02-SUMMARY.md`
</output>
