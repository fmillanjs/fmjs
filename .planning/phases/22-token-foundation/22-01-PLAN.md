---
phase: 22-token-foundation
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/app/globals.css
  - apps/web/app/(portfolio)/layout.tsx
autonomous: true
requirements:
  - THEME-01
  - THEME-02
  - THEME-04

must_haves:
  truths:
    - "CSS custom properties --matrix-green, --matrix-green-dim, --matrix-green-ghost are available on :root in every portfolio route"
    - "All CSS animations and transitions halt completely when OS Reduce Motion is active"
    - "The portfolio layout wrapper div carries the matrix-theme class (dormant — no visual change yet)"
  artifacts:
    - path: "apps/web/app/globals.css"
      provides: "Matrix green tokens in :root and global reduced-motion rule"
      contains: "--matrix-green: #00FF41"
    - path: "apps/web/app/(portfolio)/layout.tsx"
      provides: "matrix-theme class on wrapper div"
      contains: "matrix-theme"
  key_links:
    - from: "apps/web/app/globals.css"
      to: ":root"
      via: "CSS custom property declaration"
      pattern: "--matrix-green"
    - from: "apps/web/app/(portfolio)/layout.tsx"
      to: "wrapper div"
      via: "className prop"
      pattern: "matrix-theme"
---

<objective>
Add the Matrix green CSS token system to globals.css and attach the (dormant) `.matrix-theme` class to the portfolio layout wrapper div.

Purpose: Every Phase 23+ plan depends on these tokens existing. The reduced-motion global rule is the Phase 22 portion of THEME-04. The `.matrix-theme` class selector hook is planted now so future phases can attach styles without touching layout again.

Output: Three new CSS custom properties in `:root`, a global `@media (prefers-reduced-motion: reduce)` rule, and `className="matrix-theme ..."` on the portfolio layout wrapper div.
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-token-foundation/22-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Matrix green tokens and reduced-motion rule to globals.css</name>
  <files>apps/web/app/globals.css</files>
  <action>
    In `apps/web/app/globals.css`, inside the existing `:root {}` block (after the `--ring` line, before the closing brace), add the three Matrix green custom properties:

    ```css
    /* Matrix green token system — Phase 22 */
    --matrix-green: #00FF41;
    --matrix-green-dim: #00CC33;
    --matrix-green-ghost: #00FF4120;
    ```

    CRITICAL: Add to `:root {}` only. Do NOT add to `@theme inline {}` — these are raw CSS variables, not Tailwind utility tokens. Do NOT create a `.matrix-theme` CSS block here (the class is dormant in Phase 22 — styles attach in future phases).

    After the existing `@keyframes slide-in-up` and `.animate-slide-in-up` block, append the global reduced-motion rule at the very end of the file:

    ```css
    /* THEME-04: Stop all animations when OS Reduce Motion is active */
    /* Phase 22 portion — covers CSS animations/transitions globally */
    /* Canvas RAF check (Phase 23) and MotionConfig (Phase 24) handle JS animation layers */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }
    ```
  </action>
  <verify>
    Run `npm run build --workspace apps/web` from the repo root and confirm zero CSS errors.
    Then open DevTools on any portfolio route in dev mode (`npm run dev --workspace apps/web`), inspect `:root` in the Computed panel — confirm `--matrix-green: #00FF41`, `--matrix-green-dim: #00CC33`, and `--matrix-green-ghost: #00FF4120` appear.
  </verify>
  <done>Three Matrix green custom properties are present in `:root`. No Tailwind build errors. The `@media (prefers-reduced-motion: reduce)` rule exists in the compiled CSS.</done>
</task>

<task type="auto">
  <name>Task 2: Add matrix-theme class to portfolio layout wrapper div</name>
  <files>apps/web/app/(portfolio)/layout.tsx</files>
  <action>
    In `apps/web/app/(portfolio)/layout.tsx`, update the outer `<div>` className to include `matrix-theme`:

    Change:
    ```tsx
    <div className="min-h-screen flex flex-col">
    ```

    To:
    ```tsx
    <div className="matrix-theme min-h-screen flex flex-col">
    ```

    CRITICAL constraints:
    - `matrix-theme` must be the FIRST class on the div (makes selector specificity easy to reason about in future phases)
    - Do NOT add any CSS rules for `.matrix-theme` anywhere — the class is a dormant selector hook only
    - Do NOT add `matrix-theme` to the root `app/layout.tsx` — it must be scoped to the portfolio route group only
    - The TeamFlow and DevCollab dashboard routes (under `(dashboard)`) must remain visually unaffected

    No other changes to this file.
  </action>
  <verify>
    Run `npm run build --workspace apps/web` from the repo root — confirm zero TypeScript/JSX errors.
    In dev mode, visit `http://localhost:3000` and inspect the outermost div in DevTools Elements panel — confirm it has class `matrix-theme`. Then visit `http://localhost:3000/dashboard` — confirm that div does NOT have `matrix-theme`.
  </verify>
  <done>Portfolio layout wrapper div carries `matrix-theme` as its first class. Dashboard routes are unaffected. Build passes.</done>
</task>

</tasks>

<verification>
1. `npm run build --workspace apps/web` exits with code 0
2. DevTools Computed panel on any portfolio route shows `--matrix-green: #00FF41`
3. DevTools Elements on `/` shows outermost portfolio wrapper with `class="matrix-theme ..."`
4. DevTools Elements on `/dashboard` does NOT show `matrix-theme` on any wrapper
5. Toggling OS Reduce Motion in system accessibility settings causes all CSS animations on the portfolio to stop (visually static page)
</verification>

<success_criteria>
- Matrix green tokens (`--matrix-green`, `--matrix-green-dim`, `--matrix-green-ghost`) present in `:root` in globals.css
- Global `@media (prefers-reduced-motion: reduce)` rule present at end of globals.css
- `.matrix-theme` class on portfolio layout wrapper div — no CSS rules attached yet
- No visual regression on any existing page (no `.matrix-theme` CSS rules = zero visual change)
- Build passes clean
</success_criteria>

<output>
After completion, create `.planning/phases/22-token-foundation/22-01-SUMMARY.md`
</output>
