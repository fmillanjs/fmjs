---
phase: 32-matrix-color-harmony
plan: 04
type: execute
wave: 3
depends_on:
  - 32-02
  - 32-03
files_modified:
  - apps/web/e2e/portfolio/visual-regression.spec.ts-snapshots/
  - apps/web/e2e/dashboard/visual-regression.spec.ts-snapshots/
autonomous: false
requirements:
  - COLOR-08

must_haves:
  truths:
    - "All 18 Playwright visual regression snapshots pass at maxDiffPixelRatio 0.02"
    - "The 12 portfolio snapshots (6 routes x 2 modes) reflect Matrix green — no blue primary visible in any snapshot"
    - "The 6 dashboard snapshots are byte-for-byte identical to pre-Phase-32 (zero Matrix green bleed into dashboard)"
    - "Human visually confirmed: no blue remains on portfolio pages, SectionLabel prefixes appear correctly, dashboard is unchanged"
  artifacts:
    - path: "apps/web/e2e/portfolio/visual-regression.spec.ts-snapshots/"
      provides: "12 updated portfolio baseline PNGs"
    - path: "apps/web/e2e/dashboard/visual-regression.spec.ts-snapshots/"
      provides: "6 dashboard PNGs — must be unchanged"
  key_links:
    - from: "apps/web/playwright.visual.config.ts"
      to: "e2e/portfolio/visual-regression.spec.ts"
      via: "npx playwright test --config=playwright.visual.config.ts"
      pattern: "visual\\.config"
---

<objective>
Update all Playwright visual regression baselines after the Phase 32 color changes, verify all 18 snapshots pass, and confirm zero Matrix green bleed into dashboard routes (COLOR-08).

Purpose: This is the gate that proves Phase 32 is complete. The human must visually verify the updated snapshots — automated baseline update can silently bake in regressions, so visual review is mandatory before commit.

Output: 18 Playwright snapshots updated and passing, dashboard isolation confirmed, human approval recorded.
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/32-matrix-color-harmony/32-RESEARCH.md
@.planning/phases/32-matrix-color-harmony/32-01-SUMMARY.md
@.planning/phases/32-matrix-color-harmony/32-02-SUMMARY.md
@.planning/phases/32-matrix-color-harmony/32-03-SUMMARY.md

@apps/web/playwright.visual.config.ts
@apps/web/e2e/portfolio/visual-regression.spec.ts
@apps/web/e2e/dashboard/visual-regression.spec.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Full portfolio blue audit + Playwright baseline update</name>
  <files>
    apps/web/e2e/portfolio/visual-regression.spec.ts-snapshots/
    apps/web/e2e/dashboard/visual-regression.spec.ts-snapshots/
  </files>
  <action>
**Step 1 — Final blue audit:**

Before updating snapshots, do a comprehensive grep to confirm zero blue primary references remain in portfolio files:

```bash
grep -rn "text-primary\|border-primary\|from-primary\|bg-primary\|hover:text-primary\|hover:border-primary" \
  apps/web/app/\(portfolio\)/ \
  apps/web/components/portfolio/ \
  --include="*.tsx" --include="*.ts"
```

If any results appear: fix them before proceeding. Do not update snapshots until the audit is clean.

**Step 2 — Capture dashboard snapshot hashes before update:**

```bash
cd apps/web && md5sum e2e/dashboard/visual-regression.spec.ts-snapshots/*.png 2>/dev/null || sha256sum e2e/dashboard/visual-regression.spec.ts-snapshots/*.png
```

Save this output — it's the "before" fingerprint for dashboard snapshots.

**Step 3 — Update portfolio baselines:**

```bash
cd apps/web && CHROME_PATH=~/.cache/puppeteer/chrome/linux-141.0.7390.122/chrome-linux64/chrome npx playwright test --config=playwright.visual.config.ts --update-snapshots 2>&1
```

Note: CHROME_PATH is required in WSL2 (from STATE.md decision: Phase 29-03 confirmed puppeteer's Linux Chrome binary path). If the chrome version directory differs, find it with: `ls ~/.cache/puppeteer/chrome/`

**Step 4 — Verify dashboard snapshots unchanged:**

```bash
cd apps/web && md5sum e2e/dashboard/visual-regression.spec.ts-snapshots/*.png 2>/dev/null || sha256sum e2e/dashboard/visual-regression.spec.ts-snapshots/*.png
```

Compare with Step 2 output. If ANY dashboard PNG hash changed: STOP — Matrix green tokens leaked out of `.matrix-theme` into `:root`. Investigate token scoping in globals.css before proceeding.

**Step 5 — Run full suite WITHOUT --update-snapshots to confirm all 18 pass:**

```bash
cd apps/web && CHROME_PATH=~/.cache/puppeteer/chrome/linux-141.0.7390.122/chrome-linux64/chrome npx playwright test --config=playwright.visual.config.ts 2>&1
```

Expected: 18 tests passing. Any failure = snapshot mismatch — investigate and fix.

**Step 6 — Generate Playwright HTML report for visual review:**

```bash
cd apps/web && npx playwright show-report 2>/dev/null || true
```

If report cannot open in WSL2, note the path to the report for the human-verify checkpoint.
  </action>
  <verify>
cd apps/web && CHROME_PATH=~/.cache/puppeteer/chrome/linux-141.0.7390.122/chrome-linux64/chrome npx playwright test --config=playwright.visual.config.ts 2>&1 | tail -10
git diff --stat apps/web/e2e/dashboard/visual-regression.spec.ts-snapshots/
  </verify>
  <done>Playwright runs 18 tests all passing. git diff shows 0 changed files in dashboard snapshot directory (or no delta if already committed). Portfolio snapshots show visual updates consistent with Matrix green changes.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Human visual verification — Matrix green complete, dashboard clean</name>
  <action>
Phase 32 complete color sweep: 4 new CSS tokens in .matrix-theme, SectionLabel component, all blue Radix primary references replaced with Matrix green across 10 files, 12 portfolio Playwright baselines updated, 6 dashboard snapshots confirmed unchanged.
  </action>
  <verify>Human visual review of all 8 route checks listed in how-to-verify</verify>
  <done>Human approves — all portfolio sections show Matrix green, dashboard unchanged</done>
  <what-built>
Phase 32 complete color sweep: 4 new CSS tokens in .matrix-theme, SectionLabel component, all blue Radix primary references replaced with Matrix green across 10 files, 12 portfolio Playwright baselines updated, 6 dashboard snapshots confirmed unchanged.
  </what-built>
  <how-to-verify>
Run the dev server: `cd apps/web && npm run dev`

Then check each of the following:

1. **Homepage** (http://localhost:3000):
   - Featured project cards should have a GREEN border (not blue), subtle green glow on hover
   - Stat numbers (e.g. "5+ Years") should be monospace green
   - "Featured Projects" h2 should have a `> FEATURED_PROJECTS` terminal label above it in small monospace green

2. **About page** (http://localhost:3000/about):
   - Value cards (hover over them) — border should be green, NOT blue
   - CTA section gradient should be faint green, NOT blue
   - Each h2 section heading should have a small `> SECTION_NAME` label above it in green monospace

3. **Contact page** (http://localhost:3000/contact):
   - Email link should be green (not blue) with underline on hover
   - "Send a Message" and "Contact Information" h2 headings each have a green `>` prefix label

4. **TeamFlow case study** (http://localhost:3000/projects/teamflow):
   - Large metric numbers (e.g. version numbers, user counts) should be monospace green
   - Challenge section left borders should be green (not blue)
   - All CaseStudySection h2 headings should have a `>` prefix label above them

5. **DevCollab case study** (http://localhost:3000/projects/devcollab):
   - Same checks as TeamFlow — metric numbers monospace green, borders green, h2 labels

6. **Resume page** (http://localhost:3000/resume):
   - Summary, Technical Skills, Experience, Education, Projects h2 headings each have a `>` label above

7. **Footer** (visible on all pages — scroll to bottom):
   - Hover each nav link and social icon — hover color should be GREEN (not blue)

8. **TeamFlow Dashboard** (http://localhost:3000/w — or whichever dashboard route):
   - Dashboard must look completely normal — no green accents in the dashboard UI
   - Buttons, links, borders should be their normal blue/Radix colors

Confirm NO blue (Radix primary) is visible in any portfolio section across all 7 check points.
  </how-to-verify>
  <resume-signal>Type "approved" if all 8 checks pass. Or describe any blue remnants or visual issues found so they can be fixed.</resume-signal>
</task>

</tasks>

<verification>
1. All 18 Playwright snapshots pass: `cd apps/web && npx playwright test --config=playwright.visual.config.ts` exits 0
2. Dashboard snapshot hashes unchanged vs pre-Phase-32
3. Zero primary color references in portfolio files: `grep -rn "text-primary\|border-primary\|from-primary\|bg-primary\|hover:text-primary" apps/web/app/\(portfolio\)/ apps/web/components/portfolio/` returns empty
4. Human visual review approved
</verification>

<success_criteria>
- All 18 Playwright visual regression snapshots pass at maxDiffPixelRatio 0.02
- Dashboard snapshot directory shows zero git diff (no Matrix green bleed)
- Complete portfolio audit returns zero blue primary references
- Human visually confirmed: all 8 route checks pass, dashboard unaffected
- COLOR-08 requirement satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/32-matrix-color-harmony/32-04-SUMMARY.md` following the summary template.
</output>
