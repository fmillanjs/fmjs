---
phase: 23-canvas-matrix-rain
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/package.json
  - apps/web/lighthouserc.json
autonomous: true
requirements:
  - ANIM-03

must_haves:
  truths:
    - "@lhci/cli is available as a devDependency in apps/web"
    - "lighthouserc.json tests exactly the five required portfolio URLs"
    - "lighthouserc.json asserts performance score >= 0.90"
  artifacts:
    - path: "apps/web/package.json"
      provides: "@lhci/cli devDependency"
      contains: "@lhci/cli"
    - path: "apps/web/lighthouserc.json"
      provides: "Lighthouse CI config with correct five URLs and performance assertion"
      contains: "minScore.*0.9"
  key_links:
    - from: "apps/web/lighthouserc.json"
      to: "http://localhost:3000"
      via: "startServerCommand + five portfolio URLs"
      pattern: "projects/devcollab"
---

<objective>
Install @lhci/cli as a devDependency in apps/web and fix lighthouserc.json to test the five required portfolio URLs.

Purpose: ANIM-03 — enables `lhci autorun` to validate performance scores >= 0.90 on all five required URLs after canvas is added.
Output: @lhci/cli installed, lighthouserc.json updated with correct URLs and performance assertion.
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/23-canvas-matrix-rain/23-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install @lhci/cli devDependency in apps/web</name>
  <files>apps/web/package.json</files>
  <action>
    From the monorepo root `/home/doctor/fernandomillan`, run:
    ```bash
    npm install --save-dev @lhci/cli --workspace apps/web
    ```

    This installs `@lhci/cli` (latest stable, 0.15.x) as a devDependency scoped only to `apps/web`. Do NOT install it globally or in the root `package.json`. The `--workspace apps/web` flag ensures it is added to `apps/web/package.json` under `devDependencies`.

    Check if Docker is running before using any standalone server commands. The LHCI install is an npm operation and does not require Docker.
  </action>
  <verify>
    `grep "@lhci/cli" /home/doctor/fernandomillan/apps/web/package.json` — confirms entry in devDependencies.
    `cd /home/doctor/fernandomillan/apps/web && npx lhci --version` — prints version without error.
  </verify>
  <done>
    `@lhci/cli` appears in `apps/web/package.json` devDependencies. `npx lhci --version` runs successfully.
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix lighthouserc.json URL list to Phase 23 spec</name>
  <files>apps/web/lighthouserc.json</files>
  <action>
    Replace the contents of `apps/web/lighthouserc.json` with the following exact JSON. The current config has `/about` and `/login` in the URL list; these must be replaced with `/projects/devcollab` and `/contact` per ANIM-03.

    ```json
    {
      "ci": {
        "collect": {
          "startServerCommand": "npm run start",
          "startServerReadyPattern": "ready",
          "startServerReadyTimeout": 30000,
          "url": [
            "http://localhost:3000/",
            "http://localhost:3000/projects",
            "http://localhost:3000/projects/teamflow",
            "http://localhost:3000/projects/devcollab",
            "http://localhost:3000/contact"
          ],
          "numberOfRuns": 3
        },
        "assert": {
          "assertions": {
            "categories:performance": ["error", { "minScore": 0.9 }],
            "categories:accessibility": ["warn", { "minScore": 1 }]
          }
        },
        "upload": {
          "target": "temporary-public-storage"
        }
      }
    }
    ```

    The five URLs are exactly: `/`, `/projects`, `/projects/teamflow`, `/projects/devcollab`, `/contact`. These are the five URLs specified in ANIM-03 and the Phase 23 success criteria. The `startServerCommand` of `"npm run start"` starts the production server (not dev) — a prior `npm run build` is required before running LHCI.
  </action>
  <verify>
    `cat /home/doctor/fernandomillan/apps/web/lighthouserc.json` — output shows the five correct URLs including `projects/devcollab` and `contact`, with `minScore: 0.9`.
    `grep -c "localhost:3000" /home/doctor/fernandomillan/apps/web/lighthouserc.json` — outputs `5`.
  </verify>
  <done>
    `lighthouserc.json` contains exactly five URLs matching the ANIM-03 spec. `/about` and `/login` are gone. Performance assertion is `minScore: 0.9`.
  </done>
</task>

</tasks>

<verification>
After both tasks:
1. `grep "@lhci/cli" /home/doctor/fernandomillan/apps/web/package.json` — present in devDependencies
2. `grep -c "localhost:3000" /home/doctor/fernandomillan/apps/web/lighthouserc.json` — outputs 5
3. `grep "projects/devcollab" /home/doctor/fernandomillan/apps/web/lighthouserc.json` — line present
4. `grep "contact" /home/doctor/fernandomillan/apps/web/lighthouserc.json` — line present
5. No `/about` or `/login` in the URL list
</verification>

<success_criteria>
- `@lhci/cli` is in `apps/web/package.json` devDependencies
- `npx lhci --version` runs from `apps/web` without error
- `lighthouserc.json` URL list is exactly: `/`, `/projects`, `/projects/teamflow`, `/projects/devcollab`, `/contact`
- `lighthouserc.json` asserts `categories:performance` minScore 0.9
</success_criteria>

<output>
After completion, create `.planning/phases/23-canvas-matrix-rain/23-02-SUMMARY.md`
</output>
