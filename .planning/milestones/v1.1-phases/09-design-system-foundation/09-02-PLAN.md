---
phase: 09-design-system-foundation
plan: 02
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - apps/web/app/globals.css
autonomous: true
requirements: [COLOR-01, COLOR-02, COLOR-03, COLOR-04]

must_haves:
  truths:
    - "globals.css imports Radix Colors CSS files for both light and dark scales"
    - "Semantic tokens (--background, --primary, etc.) are aliased from Radix scale steps"
    - "@custom-variant dark is present enabling Tailwind v4 dark: utilities via .dark class"
    - "All 10 Phase 8 WCAG violations are resolved by the new color tokens"
    - "No hand-rolled .dark {} override block exists — Radix dark CSS handles dark mode automatically"
  artifacts:
    - path: "apps/web/app/globals.css"
      provides: "Complete Radix Colors-based design token system"
      contains: "@import \"@radix-ui/colors/blue.css\""
      min_lines: 80
  key_links:
    - from: "apps/web/app/globals.css"
      to: "@radix-ui/colors/blue-dark.css"
      via: "@import statement"
      pattern: "@import.*blue-dark\\.css"
    - from: ":root semantic tokens"
      to: "@theme inline"
      via: "CSS variable aliasing"
      pattern: "--color-background: var\\(--background\\)"
---

<objective>
Replace the existing hand-rolled OKLCH globals.css with a Radix Colors-based design token system that fixes all 10 Phase 8 WCAG violations and provides proper dual-mode (light/dark) color foundation.

Purpose: This is the color system migration (COLOR-01 through COLOR-04). The existing globals.css has a 42% WCAG failure rate. This plan replaces it entirely with Radix's WCAG-validated 12-step scales, adds the @custom-variant dark directive for Tailwind v4 class-based dark mode, and wires semantic tokens to Shadcn-compatible variable names. Dark mode works automatically via Radix dark CSS files targeting .dark class — which next-themes already writes to <html>.

Output: A single globals.css file that satisfies all color requirements and fixes all accessibility violations in one pass.
</objective>

<execution_context>
@/home/doctor/.claude/get-shit-done/workflows/execute-plan.md
@/home/doctor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-design-system-foundation/09-RESEARCH.md
@.planning/phases/09-design-system-foundation/09-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace globals.css with Radix Colors system</name>
  <files>apps/web/app/globals.css</files>
  <action>
Completely replace apps/web/app/globals.css with the following content. This is a full replacement — do NOT merge with existing content. The old hand-rolled OKLCH tokens and .dark {} block are removed entirely.

```css
@import "tailwindcss";
@import "tw-animate-css";

/* Radix Colors — light scales (scope to :root and .light) */
@import "@radix-ui/colors/slate.css";
@import "@radix-ui/colors/blue.css";
@import "@radix-ui/colors/red.css";
@import "@radix-ui/colors/green.css";
@import "@radix-ui/colors/amber.css";
@import "@radix-ui/colors/slate-alpha.css";
@import "@radix-ui/colors/blue-alpha.css";

/* Radix Colors — dark scales (scope to .dark and .dark-theme) */
@import "@radix-ui/colors/slate-dark.css";
@import "@radix-ui/colors/blue-dark.css";
@import "@radix-ui/colors/red-dark.css";
@import "@radix-ui/colors/green-dark.css";
@import "@radix-ui/colors/amber-dark.css";
@import "@radix-ui/colors/slate-dark-alpha.css";
@import "@radix-ui/colors/blue-dark-alpha.css";

/* Enable class-based dark mode — next-themes writes class="dark" to <html> */
/* Without this, Tailwind v4 dark: utilities only respond to prefers-color-scheme */
@custom-variant dark (&:where(.dark, .dark *));

/* ============================================================
   Semantic token layer — map Radix scale steps to Shadcn names
   Light values are active by default (:root)
   Dark values activate automatically when .dark is on <html>
   via the Radix dark CSS files imported above
   ============================================================ */
:root {
  --radius: 0.5rem;

  /* Backgrounds */
  --background: var(--slate-1);
  --foreground: var(--slate-12);

  --card: var(--slate-2);
  --card-foreground: var(--slate-12);

  --popover: var(--slate-1);
  --popover-foreground: var(--slate-12);

  /* Primary — Blue scale, step 9 = highest chroma (purest blue) */
  /* blue-9 pairs with white text per Radix WCAG guarantee */
  --primary: var(--blue-9);
  --primary-foreground: #ffffff;

  /* Secondary — slate-3 background with slate-11 text */
  /* Fixes Phase 8: muted-foreground 4.35:1 → slate-11 guarantees Lc 60+ APCA */
  --secondary: var(--slate-3);
  --secondary-foreground: var(--slate-11);

  /* Muted */
  --muted: var(--slate-3);
  --muted-foreground: var(--slate-11);

  /* Accent — blue-3 background with blue-11 text */
  /* Fixes Phase 8 CRITICAL: accent text was 1.21:1, blue-11 on blue-3 is guaranteed accessible */
  --accent: var(--blue-3);
  --accent-foreground: var(--blue-11);

  /* Destructive */
  --destructive: var(--red-9);
  --destructive-foreground: #ffffff;

  /* Success */
  --success: var(--green-9);
  --success-foreground: #ffffff;

  /* Warning — amber-9 bg with amber-12 text */
  /* Fixes Phase 8 CRITICAL: warning was 1.01:1, amber-12 on amber-9 satisfies 4.5:1 */
  --warning: var(--amber-9);
  --warning-foreground: var(--amber-12);

  /* UI elements */
  /* Fixes Phase 8 HIGH: all borders were 1.18-1.58:1, slate-6 guarantees 3:1 for non-interactive borders */
  --border: var(--slate-6);
  --input: var(--slate-6);
  --ring: var(--blue-8);
}

/* Expose semantic tokens as Tailwind CSS utilities via @theme inline */
/* The 'inline' keyword is REQUIRED for Tailwind v4 — do not use @theme without inline */
/* CSS variables here define bg-background, text-foreground, border-border, etc. */
@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-success: var(--success);
  --color-success-foreground: var(--success-foreground);
  --color-warning: var(--warning);
  --color-warning-foreground: var(--warning-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --radius: var(--radius);
}

/* Custom animation (carried forward from previous globals.css) */
@keyframes slide-in-up {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.animate-slide-in-up {
  animation: slide-in-up 0.3s ease-out;
}
```

**Why each section:**
- `@import "tailwindcss"` — Tailwind v4 CSS-first entry point (replaces old @tailwind directives)
- `@import "tw-animate-css"` — Shadcn animation utilities (replaces tailwindcss-animate plugin)
- Radix light imports — define --slate-1 through --slate-12, --blue-1 through --blue-12, etc. in :root
- Radix dark imports — redefine same variable names in .dark scope (same names, different values)
- `@custom-variant dark` — makes dark: utility classes respond to .dark class (next-themes uses this)
- `:root` semantic tokens — two-layer approach: Radix vars → semantic names
- `@theme inline` — exposes semantic tokens as Tailwind utility class references
- Slide-in-up animation — preserved from existing globals.css for command palette and notifications

**WCAG fixes verified by this migration:**
1. Accent text (was 1.21:1) → blue-11 on blue-3 (Radix APCA guaranteed accessible)
2. Warning button light (was 1.01:1) → amber-12 on amber-9 (step 12 on 9 satisfies 4.5:1)
3. Warning button dark (was 1.14:1) → amber-dark.css retunes amber-12 and amber-9 for dark backgrounds
4. Muted text (was 4.35:1) → slate-11 (Radix guarantees Lc 60+ APCA for step 11)
5-10. All borders/inputs (were 1.18-1.58:1) → slate-6 (designed for visible non-interactive borders at 3:1+)
  </action>
  <verify>
```bash
# Verify @custom-variant dark is present
grep "@custom-variant dark" apps/web/app/globals.css

# Verify Radix imports exist
grep "blue-dark.css" apps/web/app/globals.css
grep "slate.css" apps/web/app/globals.css

# Verify semantic tokens use Radix variables
grep "var(--blue-9)" apps/web/app/globals.css
grep "var(--slate-6)" apps/web/app/globals.css

# Verify @theme inline (not @theme without inline)
grep "@theme inline" apps/web/app/globals.css

# Verify old OKLCH tokens are GONE
grep "oklch" apps/web/app/globals.css
# Should return nothing — OKLCH tokens are completely replaced

# Verify the old .dark {} block is GONE (Radix handles dark mode via CSS imports)
grep "^\.dark {" apps/web/app/globals.css
# Should return nothing
```
  </verify>
  <done>globals.css contains: Radix Colors light + dark @imports, @custom-variant dark directive, :root semantic tokens using Radix scale steps, @theme inline exposing tokens as Tailwind utilities. Zero OKLCH tokens remain. Zero hand-rolled .dark {} block exists.</done>
</task>

</tasks>

<verification>
1. `grep "@custom-variant dark" apps/web/app/globals.css` — returns the directive
2. `grep "oklch" apps/web/app/globals.css` — returns nothing (old tokens completely replaced)
3. `grep "blue-dark.css" apps/web/app/globals.css` — confirms dark scale imported
4. `grep "@theme inline" apps/web/app/globals.css` — confirms inline keyword present
5. `grep "var(--slate-11)" apps/web/app/globals.css` — confirms WCAG-fixed muted foreground
6. `grep "var(--amber-12)" apps/web/app/globals.css` — confirms WCAG-fixed warning foreground
7. Run the WCAG audit tool to verify all violations resolved: `node .planning/phases/08-foundation-validation/contrast-calculator.js` (may need adaptation for Radix native hex values — document if tool cannot parse the new format)
</verification>

<success_criteria>
- globals.css imports all required Radix Colors CSS files (slate, blue, red, green, amber in both light and dark variants)
- @custom-variant dark directive is present for Tailwind v4 class-based dark mode
- Semantic tokens use Radix scale steps that resolve the 10 Phase 8 WCAG violations
- @theme inline exposes all semantic tokens as Tailwind utility classes
- No OKLCH tokens remain (completely replaced)
- No hand-rolled .dark {} override block exists
</success_criteria>

<output>
After completion, create `.planning/phases/09-design-system-foundation/09-02-SUMMARY.md` following the template at @/home/doctor/.claude/get-shit-done/templates/summary.md
</output>
